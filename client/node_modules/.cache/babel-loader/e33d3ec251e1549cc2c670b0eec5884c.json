{"ast":null,"code":"import _extends from \"/Users/timmereeestes/Desktop/Keaton/family_messaging/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/extends\";\nvar _jsxFileName = \"/Users/timmereeestes/Desktop/Keaton/family_messaging/client/src/CometChatWorkspace/src/components/Messages/CometChatSenderTextMessageBubble/index.js\";\nimport React from \"react\";\nimport twemoji from \"twemoji\";\nimport ReactHtmlParser from \"react-html-parser\";\n/** @jsxRuntime classic */\n\n/** @jsx jsx */\n\nimport { jsx } from \"@emotion/react\";\nimport PropTypes from \"prop-types\";\nimport { CometChat } from \"@cometchat-pro/chat\";\nimport { CometChatMessageActions, CometChatThreadedMessageReplyCount, CometChatReadReceipt, CometChatLinkPreview } from \"../\";\nimport { CometChatMessageReactions } from \"../Extensions\";\nimport { CometChatContext } from \"../../../util/CometChatContext\";\nimport { linkify, checkMessageForExtensionsData } from \"../../../util/common\";\nimport * as enums from \"../../../util/enums.js\";\nimport Translator from \"../../../resources/localization/translator\";\nimport { theme } from \"../../../resources/theme\";\nimport { messageContainerStyle, messageWrapperStyle, messageTxtWrapperStyle, messageTxtStyle, messageInfoWrapperStyle, messageReactionsWrapperStyle } from \"./style\";\n\nclass CometChatSenderTextMessageBubble extends React.Component {\n  constructor(props) {\n    super(props);\n    this.messageFrom = \"sender\";\n\n    this.getMessageText = () => {\n      let messageText = this.state.message.text; //xss extensions data\n\n      const xssData = checkMessageForExtensionsData(this.state.message, \"xss-filter\");\n\n      if (xssData && xssData.hasOwnProperty(\"sanitized_text\") && xssData.hasOwnProperty(\"hasXSS\") && xssData.hasXSS === \"yes\") {\n        messageText = xssData.sanitized_text;\n      } //datamasking extensions data\n\n\n      const maskedData = checkMessageForExtensionsData(this.state.message, \"data-masking\");\n\n      if (maskedData && maskedData.hasOwnProperty(\"data\") && maskedData.data.hasOwnProperty(\"sensitive_data\") && maskedData.data.hasOwnProperty(\"message_masked\") && maskedData.data.sensitive_data === \"yes\") {\n        messageText = maskedData.data.message_masked;\n      } //profanity extensions data\n\n\n      const profaneData = checkMessageForExtensionsData(this.state.message, \"profanity-filter\");\n\n      if (profaneData && profaneData.hasOwnProperty(\"profanity\") && profaneData.hasOwnProperty(\"message_clean\") && profaneData.profanity === \"yes\") {\n        messageText = profaneData.message_clean;\n      }\n\n      const formattedText = linkify(messageText);\n      const emojiParsedMessage = twemoji.parse(formattedText, {\n        folder: \"svg\",\n        ext: \".svg\"\n      });\n      const parsedMessage = ReactHtmlParser(emojiParsedMessage, {\n        decodeEntities: false\n      });\n      const emojiMessage = parsedMessage.filter(message => message instanceof Object && message.type === \"img\");\n      let showVariation = true; //if larger size emojis feature is disabled\n\n      if (this.state.enableLargerSizeEmojis === false) {\n        showVariation = false;\n      }\n\n      messageText = jsx(\"div\", {\n        css: messageTxtWrapperStyle(this.context),\n        className: \"message__txt__wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 7\n        }\n      }, jsx(\"p\", {\n        css: messageTxtStyle(this.props, parsedMessage, emojiMessage, showVariation),\n        className: \"message__txt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 9\n        }\n      }, parsedMessage, this.state.translatedMessage));\n      return messageText;\n    };\n\n    this.translateMessage = message => {\n      const messageId = message.id;\n      const messageText = message.text;\n      const browserLanguageCode = Translator.getBrowserLanguage().toLowerCase();\n      let translateToLanguage = browserLanguageCode;\n\n      if (browserLanguageCode.indexOf(\"-\") !== -1) {\n        const browserLanguageArray = browserLanguageCode.split(\"-\");\n        translateToLanguage = browserLanguageArray[0];\n      }\n\n      let translatedMessage = \"\";\n      CometChat.callExtension(\"message-translation\", \"POST\", \"v2/translate\", {\n        msgId: messageId,\n        text: messageText,\n        languages: [translateToLanguage]\n      }).then(result => {\n        if (result.hasOwnProperty(\"language_original\") && result[\"language_original\"] !== translateToLanguage) {\n          if (result.hasOwnProperty(\"translations\") && result.translations.length) {\n            const messageTranslation = result.translations[0];\n\n            if (messageTranslation.hasOwnProperty(\"message_translated\")) {\n              translatedMessage = `\\n(${messageTranslation[\"message_translated\"]})`;\n            }\n          } else {\n            this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\");\n          }\n        } else {\n          this.props.actionGenerated(enums.ACTIONS[\"INFO\"], [], \"SAME_LANGUAGE_MESSAGE\");\n        }\n\n        this.setState({\n          translatedMessage: translatedMessage\n        });\n      }).catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n    };\n\n    this.enableLargerSizeEmojis = () => {\n      this.context.FeatureRestriction.isLargerSizeEmojisEnabled().then(response => {\n        if (response !== this.state.enableLargerSizeEmojis) {\n          this.setState({\n            enableLargerSizeEmojis: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableLargerSizeEmojis !== false) {\n          this.setState({\n            enableLargerSizeEmojis: false\n          });\n        }\n      });\n    };\n\n    this.handleMouseHover = () => {\n      this.setState(this.toggleHoverState);\n    };\n\n    this.toggleHoverState = state => {\n      return {\n        isHovering: !state.isHovering\n      };\n    };\n\n    this.messageTextRef = /*#__PURE__*/React.createRef();\n\n    const _message = Object.assign({}, props.message, {\n      messageFrom: this.messageFrom\n    });\n\n    this.state = {\n      message: _message,\n      translatedMessage: \"\",\n      isHovering: false,\n      enableLargerSizeEmojis: false\n    };\n  }\n\n  componentDidMount() {\n    this.enableLargerSizeEmojis();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.message !== this.props.message) {\n      const message = Object.assign({}, this.props.message, {\n        messageFrom: this.messageFrom\n      });\n      this.setState({\n        message: message,\n        translatedMessage: \"\"\n      });\n    }\n\n    this.enableLargerSizeEmojis();\n  }\n\n  render() {\n    let messageText = this.getMessageText(); //linkpreview extensions data\n\n    const linkPreviewData = checkMessageForExtensionsData(this.state.message, \"link-preview\");\n\n    if (linkPreviewData && linkPreviewData.hasOwnProperty(\"links\") && linkPreviewData[\"links\"].length) {\n      messageText = jsx(CometChatLinkPreview, _extends({}, this.props, {\n        message: this.state.message,\n        messageText: messageText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 9\n        }\n      }));\n    } //messagereactions extensions data\n\n\n    let messageReactions = null;\n    const reactionsData = checkMessageForExtensionsData(this.state.message, \"reactions\");\n\n    if (reactionsData) {\n      if (Object.keys(reactionsData).length) {\n        messageReactions = jsx(\"div\", {\n          css: messageReactionsWrapperStyle(),\n          className: \"message__reaction__wrapper\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 11\n          }\n        }, jsx(CometChatMessageReactions, _extends({}, this.props, {\n          message: this.state.message,\n          reaction: reactionsData,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 13\n          }\n        })));\n      }\n    }\n\n    let toolTipView = null;\n\n    if (this.state.isHovering) {\n      toolTipView = jsx(CometChatMessageActions, _extends({}, this.props, {\n        message: this.state.message,\n        translateMessage: this.translateMessage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 9\n        }\n      }));\n    }\n\n    return jsx(\"div\", {\n      css: messageContainerStyle(),\n      className: \"sender__message__container message__text\",\n      onMouseEnter: this.handleMouseHover,\n      onMouseLeave: this.handleMouseHover,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 7\n      }\n    }, toolTipView, jsx(\"div\", {\n      css: messageWrapperStyle(),\n      className: \"message__wrapper\",\n      ref: this.messageTextRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }\n    }, messageText), messageReactions, jsx(\"div\", {\n      css: messageInfoWrapperStyle(),\n      className: \"message__info__wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }\n    }, jsx(CometChatThreadedMessageReplyCount, _extends({}, this.props, {\n      message: { ...this.state.message\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 11\n      }\n    })), jsx(CometChatReadReceipt, _extends({}, this.props, {\n      message: this.state.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }\n    }))));\n  }\n\n} // Specifies the default values for props:\n\n\nCometChatSenderTextMessageBubble.contextType = CometChatContext;\nCometChatSenderTextMessageBubble.defaultProps = {\n  theme: theme\n};\nCometChatSenderTextMessageBubble.propTypes = {\n  theme: PropTypes.object\n};\nexport { CometChatSenderTextMessageBubble };","map":{"version":3,"sources":["/Users/timmereeestes/Desktop/Keaton/family_messaging/client/src/CometChatWorkspace/src/components/Messages/CometChatSenderTextMessageBubble/index.js"],"names":["React","twemoji","ReactHtmlParser","jsx","PropTypes","CometChat","CometChatMessageActions","CometChatThreadedMessageReplyCount","CometChatReadReceipt","CometChatLinkPreview","CometChatMessageReactions","CometChatContext","linkify","checkMessageForExtensionsData","enums","Translator","theme","messageContainerStyle","messageWrapperStyle","messageTxtWrapperStyle","messageTxtStyle","messageInfoWrapperStyle","messageReactionsWrapperStyle","CometChatSenderTextMessageBubble","Component","constructor","props","messageFrom","getMessageText","messageText","state","message","text","xssData","hasOwnProperty","hasXSS","sanitized_text","maskedData","data","sensitive_data","message_masked","profaneData","profanity","message_clean","formattedText","emojiParsedMessage","parse","folder","ext","parsedMessage","decodeEntities","emojiMessage","filter","Object","type","showVariation","enableLargerSizeEmojis","context","translatedMessage","translateMessage","messageId","id","browserLanguageCode","getBrowserLanguage","toLowerCase","translateToLanguage","indexOf","browserLanguageArray","split","callExtension","msgId","languages","then","result","translations","length","messageTranslation","actionGenerated","ACTIONS","setState","catch","error","FeatureRestriction","isLargerSizeEmojisEnabled","response","handleMouseHover","toggleHoverState","isHovering","messageTextRef","createRef","assign","componentDidMount","componentDidUpdate","prevProps","render","linkPreviewData","messageReactions","reactionsData","keys","toolTipView","contextType","defaultProps","propTypes","object"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport twemoji from \"twemoji\";\nimport ReactHtmlParser from \"react-html-parser\";\n/** @jsxRuntime classic */\n/** @jsx jsx */\nimport { jsx } from \"@emotion/react\";\nimport PropTypes from \"prop-types\";\n\nimport { CometChat } from \"@cometchat-pro/chat\";\n\nimport {\n  CometChatMessageActions,\n  CometChatThreadedMessageReplyCount,\n  CometChatReadReceipt,\n  CometChatLinkPreview,\n} from \"../\";\nimport { CometChatMessageReactions } from \"../Extensions\";\n\nimport { CometChatContext } from \"../../../util/CometChatContext\";\nimport { linkify, checkMessageForExtensionsData } from \"../../../util/common\";\nimport * as enums from \"../../../util/enums.js\";\n\nimport Translator from \"../../../resources/localization/translator\";\nimport { theme } from \"../../../resources/theme\";\n\nimport {\n  messageContainerStyle,\n  messageWrapperStyle,\n  messageTxtWrapperStyle,\n  messageTxtStyle,\n  messageInfoWrapperStyle,\n  messageReactionsWrapperStyle,\n} from \"./style\";\n\nclass CometChatSenderTextMessageBubble extends React.Component {\n  static contextType = CometChatContext;\n  messageFrom = \"sender\";\n\n  constructor(props) {\n    super(props);\n\n    this.messageTextRef = React.createRef();\n\n    const message = Object.assign({}, props.message, {\n      messageFrom: this.messageFrom,\n    });\n\n    this.state = {\n      message: message,\n      translatedMessage: \"\",\n      isHovering: false,\n      enableLargerSizeEmojis: false,\n    };\n  }\n\n  componentDidMount() {\n    this.enableLargerSizeEmojis();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.message !== this.props.message) {\n      const message = Object.assign({}, this.props.message, {\n        messageFrom: this.messageFrom,\n      });\n      this.setState({ message: message, translatedMessage: \"\" });\n    }\n\n    this.enableLargerSizeEmojis();\n  }\n\n  getMessageText = () => {\n    let messageText = this.state.message.text;\n\n    //xss extensions data\n    const xssData = checkMessageForExtensionsData(\n      this.state.message,\n      \"xss-filter\"\n    );\n    if (\n      xssData &&\n      xssData.hasOwnProperty(\"sanitized_text\") &&\n      xssData.hasOwnProperty(\"hasXSS\") &&\n      xssData.hasXSS === \"yes\"\n    ) {\n      messageText = xssData.sanitized_text;\n    }\n\n    //datamasking extensions data\n    const maskedData = checkMessageForExtensionsData(\n      this.state.message,\n      \"data-masking\"\n    );\n    if (\n      maskedData &&\n      maskedData.hasOwnProperty(\"data\") &&\n      maskedData.data.hasOwnProperty(\"sensitive_data\") &&\n      maskedData.data.hasOwnProperty(\"message_masked\") &&\n      maskedData.data.sensitive_data === \"yes\"\n    ) {\n      messageText = maskedData.data.message_masked;\n    }\n\n    //profanity extensions data\n    const profaneData = checkMessageForExtensionsData(\n      this.state.message,\n      \"profanity-filter\"\n    );\n    if (\n      profaneData &&\n      profaneData.hasOwnProperty(\"profanity\") &&\n      profaneData.hasOwnProperty(\"message_clean\") &&\n      profaneData.profanity === \"yes\"\n    ) {\n      messageText = profaneData.message_clean;\n    }\n\n    const formattedText = linkify(messageText);\n\n    const emojiParsedMessage = twemoji.parse(formattedText, {\n      folder: \"svg\",\n      ext: \".svg\",\n    });\n    const parsedMessage = ReactHtmlParser(emojiParsedMessage, {\n      decodeEntities: false,\n    });\n    const emojiMessage = parsedMessage.filter(\n      (message) => message instanceof Object && message.type === \"img\"\n    );\n\n    let showVariation = true;\n    //if larger size emojis feature is disabled\n    if (this.state.enableLargerSizeEmojis === false) {\n      showVariation = false;\n    }\n\n    messageText = (\n      <div\n        css={messageTxtWrapperStyle(this.context)}\n        className=\"message__txt__wrapper\"\n      >\n        <p\n          css={messageTxtStyle(\n            this.props,\n            parsedMessage,\n            emojiMessage,\n            showVariation\n          )}\n          className=\"message__txt\"\n        >\n          {parsedMessage}\n          {this.state.translatedMessage}\n        </p>\n      </div>\n    );\n\n    return messageText;\n  };\n\n  translateMessage = (message) => {\n    const messageId = message.id;\n    const messageText = message.text;\n\n    const browserLanguageCode = Translator.getBrowserLanguage().toLowerCase();\n    let translateToLanguage = browserLanguageCode;\n    if (browserLanguageCode.indexOf(\"-\") !== -1) {\n      const browserLanguageArray = browserLanguageCode.split(\"-\");\n      translateToLanguage = browserLanguageArray[0];\n    }\n\n    let translatedMessage = \"\";\n    CometChat.callExtension(\"message-translation\", \"POST\", \"v2/translate\", {\n      msgId: messageId,\n      text: messageText,\n      languages: [translateToLanguage],\n    })\n      .then((result) => {\n        if (\n          result.hasOwnProperty(\"language_original\") &&\n          result[\"language_original\"] !== translateToLanguage\n        ) {\n          if (\n            result.hasOwnProperty(\"translations\") &&\n            result.translations.length\n          ) {\n            const messageTranslation = result.translations[0];\n            if (messageTranslation.hasOwnProperty(\"message_translated\")) {\n              translatedMessage = `\\n(${messageTranslation[\"message_translated\"]})`;\n            }\n          } else {\n            this.props.actionGenerated(\n              enums.ACTIONS[\"ERROR\"],\n              [],\n              \"SOMETHING_WRONG\"\n            );\n          }\n        } else {\n          this.props.actionGenerated(\n            enums.ACTIONS[\"INFO\"],\n            [],\n            \"SAME_LANGUAGE_MESSAGE\"\n          );\n        }\n\n        this.setState({ translatedMessage: translatedMessage });\n      })\n      .catch((error) =>\n        this.props.actionGenerated(\n          enums.ACTIONS[\"ERROR\"],\n          [],\n          \"SOMETHING_WRONG\"\n        )\n      );\n  };\n\n  enableLargerSizeEmojis = () => {\n    this.context.FeatureRestriction.isLargerSizeEmojisEnabled()\n      .then((response) => {\n        if (response !== this.state.enableLargerSizeEmojis) {\n          this.setState({ enableLargerSizeEmojis: response });\n        }\n      })\n      .catch((error) => {\n        if (this.state.enableLargerSizeEmojis !== false) {\n          this.setState({ enableLargerSizeEmojis: false });\n        }\n      });\n  };\n\n  handleMouseHover = () => {\n    this.setState(this.toggleHoverState);\n  };\n\n  toggleHoverState = (state) => {\n    return {\n      isHovering: !state.isHovering,\n    };\n  };\n\n  render() {\n    let messageText = this.getMessageText();\n\n    //linkpreview extensions data\n    const linkPreviewData = checkMessageForExtensionsData(\n      this.state.message,\n      \"link-preview\"\n    );\n    if (\n      linkPreviewData &&\n      linkPreviewData.hasOwnProperty(\"links\") &&\n      linkPreviewData[\"links\"].length\n    ) {\n      messageText = (\n        <CometChatLinkPreview\n          {...this.props}\n          message={this.state.message}\n          messageText={messageText}\n        />\n      );\n    }\n\n    //messagereactions extensions data\n    let messageReactions = null;\n    const reactionsData = checkMessageForExtensionsData(\n      this.state.message,\n      \"reactions\"\n    );\n    if (reactionsData) {\n      if (Object.keys(reactionsData).length) {\n        messageReactions = (\n          <div\n            css={messageReactionsWrapperStyle()}\n            className=\"message__reaction__wrapper\"\n          >\n            <CometChatMessageReactions\n              {...this.props}\n              message={this.state.message}\n              reaction={reactionsData}\n            />\n          </div>\n        );\n      }\n    }\n\n    let toolTipView = null;\n    if (this.state.isHovering) {\n      toolTipView = (\n        <CometChatMessageActions\n          {...this.props}\n          message={this.state.message}\n          translateMessage={this.translateMessage}\n        />\n      );\n    }\n\n    return (\n      <div\n        css={messageContainerStyle()}\n        className=\"sender__message__container message__text\"\n        onMouseEnter={this.handleMouseHover}\n        onMouseLeave={this.handleMouseHover}\n      >\n        {toolTipView}\n        <div\n          css={messageWrapperStyle()}\n          className=\"message__wrapper\"\n          ref={this.messageTextRef}\n        >\n          {messageText}\n        </div>\n\n        {messageReactions}\n\n        <div css={messageInfoWrapperStyle()} className=\"message__info__wrapper\">\n          <CometChatThreadedMessageReplyCount\n            {...this.props}\n            message={{ ...this.state.message }}\n          />\n          <CometChatReadReceipt {...this.props} message={this.state.message} />\n        </div>\n      </div>\n    );\n  }\n}\n\n// Specifies the default values for props:\nCometChatSenderTextMessageBubble.defaultProps = {\n  theme: theme,\n};\n\nCometChatSenderTextMessageBubble.propTypes = {\n  theme: PropTypes.object,\n};\n\nexport { CometChatSenderTextMessageBubble };\n"]},"metadata":{},"sourceType":"module"}