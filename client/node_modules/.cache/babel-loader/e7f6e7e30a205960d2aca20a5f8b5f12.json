{"ast":null,"code":"import _extends from \"/Users/timmereeestes/Desktop/Keaton/family_messaging/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/extends\";\nvar _jsxFileName = \"/Users/timmereeestes/Desktop/Keaton/family_messaging/client/src/CometChat/src/components/Messages/CometChatMessageComposer/index.js\";\nimport React from \"react\";\n/** @jsxRuntime classic */\n\n/** @jsx jsx */\n\nimport { jsx, keyframes } from \"@emotion/core\";\nimport PropTypes from \"prop-types\";\nimport { CometChat } from \"@cometchat-pro/chat\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { CometChatSmartReplyPreview, CometChatCreatePoll, CometChatStickerKeyboard } from \"../Extensions\";\nimport { CometChatEmojiKeyboard } from \"../\";\nimport { CometChatContext } from \"../../../util/CometChatContext\";\nimport { checkMessageForExtensionsData, ID, getUnixTimestamp } from \"../../../util/common\";\nimport * as enums from \"../../../util/enums.js\";\nimport { SoundManager } from \"../../../util/SoundManager\";\nimport { theme } from \"../../../resources/theme\";\nimport Translator from \"../../../resources/localization/translator\";\nimport { chatComposerStyle, editPreviewContainerStyle, previewHeadingStyle, previewCloseStyle, previewTextStyle, composerInputStyle, inputInnerStyle, messageInputStyle, inputStickyStyle, stickyAttachmentStyle, filePickerStyle, fileListStyle, fileItemStyle, stickyAttachButtonStyle, stickyButtonStyle, emojiButtonStyle, sendButtonStyle, reactionBtnStyle, stickerBtnStyle } from \"./style\";\nimport roundedPlus from \"./resources/add-circle-filled.svg\";\nimport videoIcon from \"./resources/video.svg\";\nimport audioIcon from \"./resources/audio-file.svg\";\nimport docIcon from \"./resources/file-upload.svg\";\nimport imageIcon from \"./resources/image.svg\";\nimport insertEmoticon from \"./resources/emoji.svg\";\nimport sendBlue from \"./resources/send-message.svg\";\nimport pollIcon from \"./resources/polls.svg\";\nimport stickerIcon from \"./resources/stickers.svg\";\nimport closeIcon from \"./resources/close.svg\";\nimport documentIcon from \"./resources/collaborative-document.svg\";\nimport whiteboardIcon from \"./resources/collaborative-whiteboard.svg\";\nimport heartIcon from \"./resources/heart.png\";\n\nclass CometChatMessageComposer extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.enableLiveReaction = () => {\n      this.context.FeatureRestriction.isLiveReactionsEnabled().then(response => {\n        if (response !== this.state.enableLiveReaction) {\n          this.setState({\n            enableLiveReaction: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableLiveReaction !== false) {\n          this.setState({\n            enableLiveReaction: false\n          });\n        }\n      });\n    };\n\n    this.enablePolls = () => {\n      this.context.FeatureRestriction.isPollsEnabled().then(response => {\n        if (response !== this.state.enablePolls) {\n          this.setState({\n            enablePolls: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enablePolls !== false) {\n          this.setState({\n            enablePolls: false\n          });\n        }\n      });\n    };\n\n    this.enableTypingIndicator = () => {\n      this.context.FeatureRestriction.isTypingIndicatorsEnabled().then(response => {\n        if (response !== this.state.enableTypingIndicator) {\n          this.setState({\n            enableTypingIndicator: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableTypingIndicator !== false) {\n          this.setState({\n            enableTypingIndicator: false\n          });\n        }\n      });\n    };\n\n    this.enableStickers = () => {\n      this.context.FeatureRestriction.isStickersEnabled().then(response => {\n        if (response !== this.state.enableStickers) {\n          this.setState({\n            enableStickers: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableStickers !== false) {\n          this.setState({\n            enableStickers: false\n          });\n        }\n      });\n    };\n\n    this.enablePhotosVideos = () => {\n      this.context.FeatureRestriction.isPhotosVideosEnabled().then(response => {\n        if (response !== this.state.enablePhotosVideos) {\n          this.setState({\n            enablePhotosVideos: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enablePhotosVideos !== false) {\n          this.setState({\n            enablePhotosVideos: false\n          });\n        }\n      });\n    };\n\n    this.enableFiles = () => {\n      this.context.FeatureRestriction.isFilesEnabled().then(response => {\n        if (response !== this.state.enableFiles) {\n          this.setState({\n            enableFiles: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableFiles !== false) {\n          this.setState({\n            enableFiles: false\n          });\n        }\n      });\n    };\n\n    this.enableEmojis = () => {\n      this.context.FeatureRestriction.isEmojisEnabled().then(response => {\n        if (response !== this.state.enableEmojis) {\n          this.setState({\n            enableEmojis: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableEmojis !== false) {\n          this.setState({\n            enableEmojis: false\n          });\n        }\n      });\n    };\n\n    this.enableCollaborativeDocument = () => {\n      this.context.FeatureRestriction.isCollaborativeDocumentEnabled().then(response => {\n        if (response !== this.state.enableCollaborativeDocument) {\n          this.setState({\n            enableCollaborativeDocument: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableCollaborativeDocument !== false) {\n          this.setState({\n            enableCollaborativeDocument: false\n          });\n        }\n      });\n    };\n\n    this.enableCollaborativeWhiteboard = () => {\n      this.context.FeatureRestriction.isCollaborativeWhiteBoardEnabled().then(response => {\n        if (response !== this.state.enableCollaborativeWhiteboard) {\n          this.setState({\n            enableCollaborativeWhiteboard: response\n          });\n        }\n      }).catch(error => {\n        if (this.state.enableCollaborativeWhiteboard !== false) {\n          this.setState({\n            enableCollaborativeWhiteboard: false\n          });\n        }\n      });\n    };\n\n    this.focusOnMessageComposer = () => {\n      if (this.messageInputRef && this.messageInputRef.current) {\n        this.messageInputRef.current.focus();\n      }\n    };\n\n    this.emojiClicked = (emoji, event) => {\n      if (this.state.messageToReact) {\n        this.reactToMessages(emoji);\n        return;\n      }\n\n      const element = this.messageInputRef.current;\n      element.focus();\n      this.pasteHtmlAtCaret(emoji.native, false);\n      this.setState({\n        messageInput: element.innerText,\n        messageType: \"text\"\n      });\n    };\n\n    this.changeHandler = event => {\n      this.startTyping();\n      const elem = event.currentTarget;\n      let messageInput = elem.textContent.trim();\n\n      if (!messageInput.length) {\n        event.currentTarget.textContent = messageInput; //return false;\n      }\n\n      this.setState({\n        messageInput: elem.innerText,\n        messageType: \"text\"\n      });\n    };\n\n    this.toggleFilePicker = () => {\n      const currentState = !this.state.showFilePicker;\n      this.setState({\n        showFilePicker: currentState\n      });\n    };\n\n    this.openFileDialogue = fileType => {\n      switch (fileType) {\n        case \"image\":\n          this.imageUploaderRef.current.click();\n          break;\n\n        case \"file\":\n          this.fileUploaderRef.current.click();\n          break;\n\n        case \"audio\":\n          this.audioUploaderRef.current.click();\n          break;\n\n        case \"video\":\n          this.videoUploaderRef.current.click();\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.onImageChange = e => {\n      if (!this.imageUploaderRef.current.files[\"0\"]) {\n        return false;\n      }\n\n      const uploadedFile = this.imageUploaderRef.current.files[\"0\"];\n      var reader = new FileReader(); // Creating reader instance from FileReader() API\n\n      reader.addEventListener(\"load\", event => {\n        // Setting up base64 URL on image\n        const newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n        this.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.IMAGE);\n      }, false);\n      reader.readAsArrayBuffer(uploadedFile);\n    };\n\n    this.onFileChange = e => {\n      if (!this.fileUploaderRef.current.files[\"0\"]) {\n        return false;\n      }\n\n      const uploadedFile = this.fileUploaderRef.current.files[\"0\"];\n      var reader = new FileReader(); // Creating reader instance from FileReader() API\n\n      reader.addEventListener(\"load\", event => {\n        // Setting up base64 URL on image\n        const newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n        this.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.FILE);\n      }, false);\n      reader.readAsArrayBuffer(uploadedFile);\n    };\n\n    this.onAudioChange = e => {\n      if (!this.audioUploaderRef.current.files[\"0\"]) {\n        return false;\n      }\n\n      const uploadedFile = this.audioUploaderRef.current.files[\"0\"];\n      var reader = new FileReader(); // Creating reader instance from FileReader() API\n\n      reader.addEventListener(\"load\", () => {\n        // Setting up base64 URL on image\n        const newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n        this.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.AUDIO);\n      }, false);\n      reader.readAsArrayBuffer(uploadedFile);\n    };\n\n    this.onVideoChange = e => {\n      if (!this.videoUploaderRef.current.files[\"0\"]) {\n        return false;\n      }\n\n      const uploadedFile = this.videoUploaderRef.current.files[\"0\"];\n      var reader = new FileReader(); // Creating reader instance from FileReader() API\n\n      reader.addEventListener(\"load\", () => {\n        // Setting up base64 URL on image\n        const newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n        this.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.VIDEO);\n      }, false);\n      reader.readAsArrayBuffer(uploadedFile);\n    };\n\n    this.getReceiverDetails = () => {\n      let receiverId;\n      let receiverType;\n\n      if (this.context.type === CometChat.ACTION_TYPE.TYPE_USER) {\n        receiverId = this.context.item.uid;\n        receiverType = CometChat.RECEIVER_TYPE.USER;\n      } else if (this.context.type === CometChat.ACTION_TYPE.TYPE_GROUP) {\n        receiverId = this.context.item.guid;\n        receiverType = CometChat.RECEIVER_TYPE.GROUP;\n      }\n\n      return {\n        receiverId: receiverId,\n        receiverType: receiverType\n      };\n    };\n\n    this.sendMediaMessage = (messageInput, messageType) => {\n      this.toggleFilePicker();\n      this.endTyping(null, null);\n      const {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      let mediaMessage = new CometChat.MediaMessage(receiverId, messageInput, messageType, receiverType);\n\n      if (this.props.parentMessageId) {\n        mediaMessage.setParentMessageId(this.props.parentMessageId);\n      }\n\n      mediaMessage.setSender(this.loggedInUser);\n      mediaMessage.setReceiver(this.context.type);\n      mediaMessage.setType(messageType);\n      mediaMessage.setData({\n        type: messageType,\n        category: CometChat.CATEGORY_MESSAGE,\n        name: messageInput[\"name\"],\n        file: messageInput\n      });\n      mediaMessage._composedAt = getUnixTimestamp();\n      mediaMessage._id = ID();\n      SoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n      this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [mediaMessage]);\n      CometChat.sendMessage(mediaMessage).then(message => {\n        const newMessageObj = { ...message,\n          _id: mediaMessage._id\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n      }).catch(error => {\n        const newMessageObj = { ...mediaMessage,\n          error: error\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n      });\n    };\n\n    this.sendMessageOnEnter = event => {\n      if (event.keyCode === 13 && !event.shiftKey) {\n        event.preventDefault();\n        this.sendTextMessage();\n        return true;\n      }\n    };\n\n    this.sendTextMessage = () => {\n      if (this.state.emojiViewer) {\n        this.setState({\n          emojiViewer: false\n        });\n      }\n\n      if (!this.state.messageInput.trim().length) {\n        return false;\n      }\n\n      if (this.state.messageToBeEdited) {\n        this.editMessage();\n        return false;\n      }\n\n      this.endTyping(null, null);\n      let {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      let messageInput = this.state.messageInput.trim();\n      let textMessage = new CometChat.TextMessage(receiverId, messageInput, receiverType);\n\n      if (this.props.parentMessageId) {\n        textMessage.setParentMessageId(this.props.parentMessageId);\n      }\n\n      textMessage.setSender(this.loggedInUser);\n      textMessage.setReceiver(this.context.type);\n      textMessage.setText(messageInput);\n      textMessage._composedAt = getUnixTimestamp();\n      textMessage._id = ID();\n      this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [textMessage]);\n      this.setState({\n        messageInput: \"\",\n        replyPreview: false\n      });\n      this.messageInputRef.current.textContent = \"\";\n      SoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n      CometChat.sendMessage(textMessage).then(message => {\n        const newMessageObj = { ...message,\n          _id: textMessage._id\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n      }).catch(error => {\n        const newMessageObj = { ...textMessage,\n          error: error\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n\n        if (error && error.hasOwnProperty(\"code\") && error.code === \"ERR_GUID_NOT_FOUND\") {//this.context.setDeletedGroupId(this.context.item.guid);\n        }\n      });\n    };\n\n    this.editMessage = () => {\n      this.endTyping(null, null);\n      const messageToBeEdited = this.props.messageToBeEdited;\n      let {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      let messageText = this.state.messageInput.trim();\n      let textMessage = new CometChat.TextMessage(receiverId, messageText, receiverType);\n      textMessage.setId(messageToBeEdited.id);\n      const newMessage = Object.assign({}, textMessage, {\n        messageFrom: messageToBeEdited.messageFrom\n      });\n      this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_EDITED\"], newMessage);\n      this.setState({\n        messageInput: \"\"\n      });\n      this.messageInputRef.current.textContent = \"\";\n      SoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n      this.closeEditPreview();\n      CometChat.editMessage(textMessage).then(message => {\n        this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_EDITED\"], { ...message\n        });\n      }).catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n    };\n\n    this.closeEditPreview = () => {\n      this.props.actionGenerated(enums.ACTIONS[\"CLEAR_EDIT_PREVIEW\"]);\n    };\n\n    this.startTyping = (timer, metadata) => {\n      let typingInterval = timer || 5000; //if typing indicator feature is disabled\n\n      if (this.state.enableTypingIndicator === false) {\n        return false;\n      }\n\n      if (this.isTyping) {\n        return false;\n      }\n\n      let {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      let typingMetadata = metadata || undefined;\n      let typingNotification = new CometChat.TypingIndicator(receiverId, receiverType, typingMetadata);\n      CometChat.startTyping(typingNotification);\n      this.isTyping = setTimeout(() => {\n        this.endTyping(null, typingMetadata);\n      }, typingInterval);\n    };\n\n    this.endTyping = (event, metadata) => {\n      //fixing synthetic issue\n      if (event) {\n        event.persist();\n      } //if typing indicator is disabled for chat wigdet in dashboard\n\n\n      if (this.state.enableTypingIndicator === false) {\n        return false;\n      }\n\n      let {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      let typingMetadata = metadata || undefined;\n      let typingNotification = new CometChat.TypingIndicator(receiverId, receiverType, typingMetadata);\n      CometChat.endTyping(typingNotification);\n      clearTimeout(this.isTyping);\n      this.isTyping = null;\n    };\n\n    this.toggleStickerPicker = () => {\n      const stickerViewer = this.state.stickerViewer;\n      this.setState({\n        stickerViewer: !stickerViewer,\n        emojiViewer: false\n      });\n    };\n\n    this.toggleEmojiPicker = () => {\n      const emojiViewer = this.state.emojiViewer;\n      this.setState({\n        emojiViewer: !emojiViewer,\n        stickerViewer: false\n      });\n    };\n\n    this.toggleCreatePoll = () => {\n      const createPoll = this.state.createPoll;\n      this.setState({\n        createPoll: !createPoll\n      });\n    };\n\n    this.toggleCollaborativeDocument = () => {\n      const {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      CometChat.callExtension(\"document\", \"POST\", \"v1/create\", {\n        receiver: receiverId,\n        receiverType: receiverType\n      }).then(response => {\n        // Response with document url\n        if (response && response.hasOwnProperty(\"document_url\")) {\n          this.context.setToastMessage(\"success\", \"DOCUMENT_SUCCESS\");\n        } else {\n          this.context.setToastMessage(\"error\", \"DOCUMENT_FAIL\");\n        }\n      }).catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n    };\n\n    this.toggleCollaborativeBoard = () => {\n      const {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      CometChat.callExtension(\"whiteboard\", \"POST\", \"v1/create\", {\n        receiver: receiverId,\n        receiverType: receiverType\n      }).then(response => {\n        // Response with board_url\n        if (response && response.hasOwnProperty(\"board_url\")) {\n          this.context.setToastMessage(\"success\", \"WHITEBOARD_SUCCESS\");\n        } else {\n          this.context.setToastMessage(\"error\", \"WHITEBOARD_FAIL\");\n        }\n      }).catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n    };\n\n    this.closeCreatePoll = () => {\n      this.toggleCreatePoll();\n      this.toggleFilePicker();\n    };\n\n    this.actionHandler = (action, message) => {\n      switch (action) {\n        case enums.ACTIONS[\"POLL_CREATED\"]:\n          this.toggleCreatePoll();\n          this.toggleFilePicker();\n          break;\n\n        case enums.ACTIONS[\"SEND_STICKER\"]:\n          this.sendSticker(message);\n          break;\n\n        case enums.ACTIONS[\"CLOSE_STICKER_KEYBOARD\"]:\n          this.toggleStickerPicker();\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.sendSticker = stickerMessage => {\n      const {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      const customData = {\n        sticker_url: stickerMessage.stickerUrl,\n        sticker_name: stickerMessage.stickerName\n      };\n      const customType = enums.CUSTOM_TYPE_STICKER;\n      const customMessage = new CometChat.CustomMessage(receiverId, receiverType, customType, customData);\n\n      if (this.props.parentMessageId) {\n        customMessage.setParentMessageId(this.props.parentMessageId);\n      }\n\n      customMessage.setSender(this.loggedInUser);\n      customMessage.setReceiver(this.context.type);\n      customMessage.setMetadata({\n        incrementUnreadCount: true\n      });\n      customMessage._composedAt = getUnixTimestamp();\n      customMessage._id = ID();\n      this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [customMessage]);\n      SoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n      CometChat.sendCustomMessage(customMessage).then(message => {\n        const newMessageObj = { ...message,\n          _id: customMessage._id\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n      }).catch(error => {\n        const newMessageObj = { ...customMessage,\n          error: error\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n      });\n    };\n\n    this.sendReplyMessage = messageInput => {\n      let {\n        receiverId,\n        receiverType\n      } = this.getReceiverDetails();\n      let textMessage = new CometChat.TextMessage(receiverId, messageInput, receiverType);\n\n      if (this.props.parentMessageId) {\n        textMessage.setParentMessageId(this.props.parentMessageId);\n      }\n\n      textMessage.setSender(this.loggedInUser);\n      textMessage.setReceiver(this.context.type);\n      textMessage._composedAt = getUnixTimestamp();\n      textMessage._id = ID();\n      this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [textMessage]);\n      SoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n      this.setState({\n        replyPreview: null\n      });\n      CometChat.sendMessage(textMessage).then(message => {\n        const newMessageObj = { ...message,\n          _id: textMessage._id\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n      }).catch(error => {\n        const newMessageObj = { ...textMessage,\n          error: error\n        };\n        this.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n      });\n    };\n\n    this.clearReplyPreview = () => {\n      this.setState({\n        replyPreview: null\n      });\n    };\n\n    this.sendReaction = event => {\n      const typingInterval = 1000;\n      const typingMetadata = {\n        type: enums.CONSTANTS[\"METADATA_TYPE_LIVEREACTION\"],\n        reaction: this.props.reaction\n      };\n      this.startTyping(typingInterval, typingMetadata);\n      this.props.actionGenerated(enums.ACTIONS[\"SEND_LIVE_REACTION\"]);\n      event.persist();\n      setTimeout(() => {\n        //this.endTyping(null, typingMetadata);\n        this.props.actionGenerated(enums.ACTIONS[\"STOP_LIVE_REACTION\"]);\n      }, typingInterval);\n    };\n\n    this.reactToMessages = emoji => {\n      CometChat.callExtension(\"reactions\", \"POST\", \"v1/react\", {\n        msgId: this.state.messageToReact.id,\n        emoji: emoji.colons\n      }).then(response => {\n        if (response.hasOwnProperty(\"success\") && response[\"success\"] === true) {\n          this.toggleEmojiPicker();\n        } else {\n          this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\");\n        }\n      }).catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n    };\n\n    this.imageUploaderRef = /*#__PURE__*/React.createRef();\n    this.fileUploaderRef = /*#__PURE__*/React.createRef();\n    this.audioUploaderRef = /*#__PURE__*/React.createRef();\n    this.videoUploaderRef = /*#__PURE__*/React.createRef();\n    this.messageInputRef = /*#__PURE__*/React.createRef();\n    this.isTyping = false;\n    this.state = {\n      showFilePicker: false,\n      messageInput: \"\",\n      messageType: \"\",\n      emojiViewer: false,\n      createPoll: false,\n      messageToBeEdited: \"\",\n      replyPreview: null,\n      stickerViewer: false,\n      messageToReact: \"\",\n      shareDocument: false,\n      shareWhiteboard: false,\n      enableLiveReaction: false,\n      enablePolls: false,\n      enableTypingIndicator: false,\n      enableStickers: false,\n      enablePhotosVideos: false,\n      enableFiles: false,\n      enableEmojis: false,\n      enableCollaborativeDocument: false,\n      enableCollaborativeWhiteboard: false\n    };\n  }\n\n  componentDidMount() {\n    CometChat.getLoggedinUser().then(user => this.loggedInUser = user).catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n    this.item = this.context.type === CometChat.ACTION_TYPE.TYPE_USER || this.context.type === CometChat.ACTION_TYPE.TYPE_GROUP ? this.context.item : null;\n    this.enableLiveReaction();\n    this.enablePolls();\n    this.enableTypingIndicator();\n    this.enableStickers();\n    this.enablePhotosVideos();\n    this.enableFiles();\n    this.enableEmojis();\n    this.enableCollaborativeDocument();\n    this.enableCollaborativeWhiteboard();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.messageToBeEdited !== this.props.messageToBeEdited) {\n      const messageToBeEdited = this.props.messageToBeEdited;\n      this.setState({\n        messageInput: messageToBeEdited,\n        messageToBeEdited: messageToBeEdited\n      });\n      const element = this.messageInputRef.current;\n\n      if (messageToBeEdited) {\n        let messageText = messageToBeEdited.text; //xss extensions data\n\n        const xssData = checkMessageForExtensionsData(messageToBeEdited, \"xss-filter\");\n\n        if (xssData && xssData.hasOwnProperty(\"sanitized_text\") && xssData.hasOwnProperty(\"hasXSS\") && xssData.hasXSS === \"yes\") {\n          messageText = xssData.sanitized_text;\n        }\n\n        element.focus();\n        element.textContent = \"\";\n        this.pasteHtmlAtCaret(messageText, false);\n      } else {\n        element.textContent = \"\";\n      }\n    }\n\n    if (prevProps.replyPreview !== this.props.replyPreview) {\n      this.setState({\n        replyPreview: this.props.replyPreview\n      });\n    }\n\n    const previousMessageStr = JSON.stringify(prevProps.messageToReact);\n    const currentMessageStr = JSON.stringify(this.props.messageToReact);\n\n    if (previousMessageStr !== currentMessageStr) {\n      this.setState({\n        messageToReact: this.props.messageToReact\n      });\n    }\n\n    if (this.context.item !== this.item) {\n      this.messageInputRef.current.textContent = \"\";\n      this.setState({\n        stickerViewer: false,\n        emojiViewer: false,\n        replyPreview: null,\n        messageToBeEdited: \"\",\n        messageInput: \"\"\n      });\n      this.focusOnMessageComposer();\n    }\n\n    if (prevState.messageInput !== this.state.messageInput) {\n      this.focusOnMessageComposer();\n    }\n\n    this.item = this.context.type === CometChat.ACTION_TYPE.TYPE_USER || this.context.type === CometChat.ACTION_TYPE.TYPE_GROUP ? this.context.item : null;\n    this.enableLiveReaction();\n    this.enablePolls();\n    this.enableTypingIndicator();\n    this.enableStickers();\n    this.enablePhotosVideos();\n    this.enableFiles();\n    this.enableEmojis();\n    this.enableCollaborativeDocument();\n    this.enableCollaborativeWhiteboard();\n  }\n  /**\n   * if live reactions feature is disabled\n   */\n\n\n  pasteHtmlAtCaret(html, selectPastedContent) {\n    var sel, range;\n    const chatWindow = this.context.UIKitSettings.chatWindow;\n\n    if (chatWindow.getSelection) {\n      // IE9 and non-IE\n      sel = chatWindow.getSelection();\n\n      if (sel.getRangeAt && sel.rangeCount) {\n        range = sel.getRangeAt(0);\n        range.deleteContents(); // Range.createContextualFragment() would be useful here but is\n        // only relatively recently standardized and is not supported in\n        // some browsers (IE9, for one)\n\n        var el = document.createElement(\"div\");\n        el.innerText = html;\n        var frag = document.createDocumentFragment(),\n            node,\n            lastNode;\n\n        while (node = el.firstChild) {\n          lastNode = frag.appendChild(node);\n        }\n\n        var firstNode = frag.firstChild;\n        range.insertNode(frag); // Preserve the selection\n\n        if (lastNode) {\n          range = range.cloneRange();\n          range.setStartAfter(lastNode);\n\n          if (selectPastedContent) {\n            range.setStartBefore(firstNode);\n          } else {\n            range.collapse(true);\n          }\n\n          sel.removeAllRanges();\n          sel.addRange(range);\n        }\n      }\n    } else if ((sel = document.selection) && sel.type !== \"Control\") {\n      // IE < 9\n      var originalRange = sel.createRange();\n      originalRange.collapse(true);\n      sel.createRange().pasteHTML(html);\n\n      if (selectPastedContent) {\n        range = sel.createRange();\n        range.setEndPoint(\"StartToStart\", originalRange);\n        range.select();\n      }\n    }\n  }\n\n  render() {\n    let liveReactionBtn = null;\n    const liveReactionText = Translator.translate(\"LIVE_REACTION\", this.props.lang);\n\n    if (enums.CONSTANTS[\"LIVE_REACTIONS\"].hasOwnProperty(this.props.reaction)) {\n      const reactionName = this.props.reaction;\n      liveReactionBtn = jsx(\"div\", {\n        title: liveReactionText,\n        css: reactionBtnStyle(),\n        className: \"button__reactions\",\n        onClick: this.sendReaction,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 878,\n          columnNumber: 5\n        }\n      }, jsx(\"img\", {\n        src: heartIcon,\n        alt: reactionName,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 879,\n          columnNumber: 6\n        }\n      }));\n    }\n\n    let disabledState = false;\n\n    if (this.context.item.blockedByMe) {\n      disabledState = true;\n    }\n\n    const docText = Translator.translate(\"ATTACH_FILE\", this.props.lang);\n    let docs = jsx(\"div\", {\n      title: docText,\n      css: fileItemStyle(docIcon, this.context),\n      className: \"filelist__item item__file\",\n      onClick: () => {\n        this.openFileDialogue(\"file\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 891,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 898,\n        columnNumber: 5\n      }\n    }), jsx(\"input\", {\n      onChange: this.onFileChange,\n      type: \"file\",\n      id: \"file\",\n      ref: this.fileUploaderRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 899,\n        columnNumber: 5\n      }\n    }));\n    const videoText = Translator.translate(\"ATTACH_VIDEO\", this.props.lang);\n    const audioText = Translator.translate(\"ATTACH_AUDIO\", this.props.lang);\n    const imageText = Translator.translate(\"ATTACH_IMAGE\", this.props.lang);\n    let avp = jsx(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 907,\n        columnNumber: 4\n      }\n    }, jsx(\"div\", {\n      title: videoText,\n      css: fileItemStyle(videoIcon, this.context),\n      className: \"filelist__item item__video\",\n      onClick: () => {\n        this.openFileDialogue(\"video\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 908,\n        columnNumber: 5\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 915,\n        columnNumber: 6\n      }\n    }), jsx(\"input\", {\n      onChange: this.onVideoChange,\n      accept: \"video/*\",\n      type: \"file\",\n      ref: this.videoUploaderRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 916,\n        columnNumber: 6\n      }\n    })), jsx(\"div\", {\n      title: audioText,\n      css: fileItemStyle(audioIcon, this.context),\n      className: \"filelist__item item__audio\",\n      onClick: () => {\n        this.openFileDialogue(\"audio\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 918,\n        columnNumber: 5\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 925,\n        columnNumber: 6\n      }\n    }), jsx(\"input\", {\n      onChange: this.onAudioChange,\n      accept: \"audio/*\",\n      type: \"file\",\n      ref: this.audioUploaderRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 926,\n        columnNumber: 6\n      }\n    })), jsx(\"div\", {\n      title: imageText,\n      css: fileItemStyle(imageIcon, this.context),\n      className: \"filelist__item item__image\",\n      onClick: () => {\n        this.openFileDialogue(\"image\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 928,\n        columnNumber: 5\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 935,\n        columnNumber: 6\n      }\n    }), jsx(\"input\", {\n      onChange: this.onImageChange,\n      accept: \"image/*\",\n      type: \"file\",\n      ref: this.imageUploaderRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 936,\n        columnNumber: 6\n      }\n    })));\n    const pollText = Translator.translate(\"CREATE_POLL\", this.props.lang);\n    let createPollBtn = jsx(\"div\", {\n      title: pollText,\n      css: fileItemStyle(pollIcon, this.context),\n      className: \"filelist__item item__poll\",\n      onClick: this.toggleCreatePoll,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 943,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 944,\n        columnNumber: 5\n      }\n    }));\n    const collaborativeDocText = Translator.translate(\"COLLABORATE_USING_DOCUMENT\", this.props.lang);\n    let collaborativeDocBtn = jsx(\"div\", {\n      title: collaborativeDocText,\n      css: fileItemStyle(documentIcon, this.context),\n      className: \"filelist__item item__document\",\n      onClick: this.toggleCollaborativeDocument,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 950,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 951,\n        columnNumber: 5\n      }\n    }));\n    const collaborativeBoardText = Translator.translate(\"COLLABORATE_USING_WHITEBOARD\", this.props.lang);\n    let collaborativeBoardBtn = jsx(\"div\", {\n      title: collaborativeBoardText,\n      css: fileItemStyle(whiteboardIcon, this.context),\n      className: \"filelist__item item__whiteboard\",\n      onClick: this.toggleCollaborativeBoard,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 957,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 958,\n        columnNumber: 5\n      }\n    }));\n    const emojiText = Translator.translate(\"EMOJI\", this.props.lang);\n    let emojiBtn = jsx(\"div\", {\n      title: emojiText,\n      css: emojiButtonStyle(insertEmoticon, this.context),\n      className: \"button__emoji\",\n      onClick: () => {\n        this.toggleEmojiPicker();\n        this.setState({\n          messageToReact: \"\"\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 964,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 972,\n        columnNumber: 5\n      }\n    }));\n    const StickerText = Translator.translate(\"STICKER\", this.props.lang);\n    let stickerBtn = jsx(\"div\", {\n      title: StickerText,\n      css: stickerBtnStyle(stickerIcon, this.context),\n      className: \"button__sticker\",\n      onClick: this.toggleStickerPicker,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 978,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 979,\n        columnNumber: 5\n      }\n    }));\n    const sendMessageText = Translator.translate(\"SEND_MESSAGE\", this.props.lang);\n    let sendBtn = jsx(\"div\", {\n      title: sendMessageText,\n      css: sendButtonStyle(sendBlue, this.context),\n      className: \"button__send\",\n      onClick: this.sendTextMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 985,\n        columnNumber: 4\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 986,\n        columnNumber: 5\n      }\n    })); //if uploading photos, videos feature is disabled\n\n    if (this.state.enablePhotosVideos === false) {\n      avp = null;\n    } //if files upload are disabled for chat widget in dashboard\n\n\n    if (this.state.enableFiles === false) {\n      docs = null;\n    } //if polls feature is disabled\n\n\n    if (this.state.enablePolls === false || this.props.parentMessageId) {\n      createPollBtn = null;\n    } //if collaborative_document are disabled for chat widget in dashboard\n\n\n    if (this.state.enableCollaborativeDocument === false || this.props.parentMessageId) {\n      collaborativeDocBtn = null;\n    } //if collaborative_document are disabled for chat widget in dashboard\n\n\n    if (this.state.enableCollaborativeWhiteboard === false || this.props.parentMessageId) {\n      collaborativeBoardBtn = null;\n    } //if emojis are disabled for chat widget in dashboard\n\n\n    if (this.state.enableEmojis === false) {\n      emojiBtn = null;\n    } //if live reactions is disabled for chat widget in dashboard\n\n\n    if (this.state.enableLiveReaction === false || this.state.messageInput.length) {\n      liveReactionBtn = null;\n    } //if stickers is disabled for chat widget in dashboard\n\n\n    if (this.state.enableStickers === false) {\n      stickerBtn = null;\n    }\n\n    if (!this.state.messageInput.length) {\n      sendBtn = null;\n    }\n\n    const attachText = Translator.translate(\"ATTACH\", this.props.lang);\n    let attach = jsx(\"div\", {\n      css: stickyAttachmentStyle(),\n      className: \"input__sticky__attachment\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1036,\n        columnNumber: 4\n      }\n    }, jsx(\"div\", {\n      css: stickyAttachButtonStyle(roundedPlus, this.context),\n      className: \"attachment__icon\",\n      onClick: this.toggleFilePicker,\n      title: attachText,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1037,\n        columnNumber: 5\n      }\n    }, jsx(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1038,\n        columnNumber: 6\n      }\n    })), jsx(\"div\", {\n      css: filePickerStyle(this.state),\n      className: \"attachment__filepicker\",\n      dir: Translator.getDirection(this.props.lang),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1040,\n        columnNumber: 5\n      }\n    }, jsx(\"div\", {\n      css: fileListStyle(),\n      className: \"filepicker__filelist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1041,\n        columnNumber: 6\n      }\n    }, avp, docs, createPollBtn, collaborativeDocBtn, collaborativeBoardBtn)));\n\n    if (avp === null && docs === null && createPollBtn === null && collaborativeDocBtn === null && collaborativeBoardBtn === null) {\n      attach = null;\n    }\n\n    let createPoll = null;\n\n    if (this.state.createPoll) {\n      createPoll = jsx(CometChatCreatePoll, {\n        theme: this.props.theme,\n        open: this.state.createPoll,\n        close: this.closeCreatePoll,\n        lang: this.props.lang,\n        widgetsettings: this.props.widgetsettings,\n        actionGenerated: this.actionHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1058,\n          columnNumber: 17\n        }\n      });\n    }\n\n    let editPreview = null;\n\n    if (this.state.messageToBeEdited) {\n      let messageText = this.state.messageToBeEdited.text; //xss extensions data\n\n      const xssData = checkMessageForExtensionsData(this.state.messageToBeEdited, \"xss-filter\");\n\n      if (xssData && xssData.hasOwnProperty(\"sanitized_text\") && xssData.hasOwnProperty(\"hasXSS\") && xssData.hasXSS === \"yes\") {\n        messageText = xssData.sanitized_text;\n      } //datamasking extensions data\n\n\n      const maskedData = checkMessageForExtensionsData(this.state.messageToBeEdited, \"data-masking\");\n\n      if (maskedData && maskedData.hasOwnProperty(\"data\") && maskedData.data.hasOwnProperty(\"sensitive_data\") && maskedData.data.hasOwnProperty(\"message_masked\") && maskedData.data.sensitive_data === \"yes\") {\n        messageText = maskedData.data.message_masked;\n      } //profanity extensions data\n\n\n      const profaneData = checkMessageForExtensionsData(this.state.messageToBeEdited, \"profanity-filter\");\n\n      if (profaneData && profaneData.hasOwnProperty(\"profanity\") && profaneData.hasOwnProperty(\"message_clean\") && profaneData.profanity === \"yes\") {\n        messageText = profaneData.message_clean;\n      }\n\n      editPreview = jsx(\"div\", {\n        css: editPreviewContainerStyle(this.context, keyframes),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1084,\n          columnNumber: 5\n        }\n      }, jsx(\"div\", {\n        css: previewHeadingStyle(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1085,\n          columnNumber: 6\n        }\n      }, jsx(\"div\", {\n        css: previewTextStyle(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1086,\n          columnNumber: 7\n        }\n      }, Translator.translate(\"EDIT_MESSAGE\", this.props.lang)), jsx(\"span\", {\n        css: previewCloseStyle(closeIcon, this.context),\n        onClick: this.closeEditPreview,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1087,\n          columnNumber: 7\n        }\n      })), jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1089,\n          columnNumber: 6\n        }\n      }, messageText));\n    }\n\n    let smartReplyPreview = null;\n\n    if (this.state.replyPreview) {\n      const message = this.state.replyPreview;\n      const smartReplyData = checkMessageForExtensionsData(message, \"smart-reply\");\n\n      if (smartReplyData && smartReplyData.hasOwnProperty(\"error\") === false) {\n        const options = [smartReplyData[\"reply_positive\"], smartReplyData[\"reply_neutral\"], smartReplyData[\"reply_negative\"]];\n        smartReplyPreview = jsx(CometChatSmartReplyPreview, _extends({}, this.props, {\n          options: options,\n          clicked: this.sendReplyMessage,\n          close: this.clearReplyPreview,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1101,\n            columnNumber: 25\n          }\n        }));\n      }\n    }\n\n    let stickerViewer = null;\n\n    if (this.state.stickerViewer) {\n      stickerViewer = jsx(CometChatStickerKeyboard, {\n        theme: this.props.theme,\n        lang: this.props.lang,\n        widgetsettings: this.props.widgetsettings,\n        actionGenerated: this.actionHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1107,\n          columnNumber: 20\n        }\n      });\n    }\n\n    let emojiViewer = null;\n\n    if (this.state.emojiViewer) {\n      emojiViewer = jsx(CometChatEmojiKeyboard, {\n        lang: this.props.lang,\n        emojiClicked: this.emojiClicked,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1112,\n          columnNumber: 18\n        }\n      });\n    }\n\n    return jsx(\"div\", {\n      css: chatComposerStyle(this.context),\n      className: \"chat__composer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1116,\n        columnNumber: 4\n      }\n    }, editPreview, smartReplyPreview, stickerViewer, emojiViewer, jsx(\"div\", {\n      css: composerInputStyle(),\n      className: \"composer__input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1121,\n        columnNumber: 5\n      }\n    }, jsx(\"div\", {\n      tabIndex: \"-1\",\n      css: inputInnerStyle(this.props, this.state, this.context),\n      className: \"input__inner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1122,\n        columnNumber: 6\n      }\n    }, jsx(\"div\", {\n      css: messageInputStyle(disabledState),\n      className: \"input__message-input\",\n      contentEditable: \"true\",\n      placeholder: Translator.translate(\"ENTER_YOUR_MESSAGE_HERE\", this.props.lang),\n      dir: Translator.getDirection(this.props.lang),\n      onInput: this.changeHandler,\n      onBlur: event => this.endTyping(event),\n      onKeyDown: this.sendMessageOnEnter,\n      ref: this.messageInputRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1123,\n        columnNumber: 7\n      }\n    }), jsx(\"div\", {\n      css: inputStickyStyle(disabledState, attach, this.context),\n      className: \"input__sticky\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1132,\n        columnNumber: 7\n      }\n    }, attach, jsx(\"div\", {\n      css: stickyButtonStyle(this.state),\n      className: \"input__sticky__buttons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1134,\n        columnNumber: 8\n      }\n    }, stickerBtn, emojiBtn, sendBtn, liveReactionBtn)))), createPoll);\n  }\n\n} // Specifies the default values for props:\n\n\nCometChatMessageComposer.contextType = CometChatContext;\nCometChatMessageComposer.defaultProps = {\n  lang: Translator.getDefaultLanguage(),\n  theme: theme,\n  reaction: \"heart\"\n};\nCometChatMessageComposer.propTypes = {\n  lang: PropTypes.string,\n  theme: PropTypes.object,\n  reaction: PropTypes.string\n};\nexport { CometChatMessageComposer };","map":{"version":3,"sources":["/Users/timmereeestes/Desktop/Keaton/family_messaging/client/src/CometChat/src/components/Messages/CometChatMessageComposer/index.js"],"names":["React","jsx","keyframes","PropTypes","CometChat","CometChatSmartReplyPreview","CometChatCreatePoll","CometChatStickerKeyboard","CometChatEmojiKeyboard","CometChatContext","checkMessageForExtensionsData","ID","getUnixTimestamp","enums","SoundManager","theme","Translator","chatComposerStyle","editPreviewContainerStyle","previewHeadingStyle","previewCloseStyle","previewTextStyle","composerInputStyle","inputInnerStyle","messageInputStyle","inputStickyStyle","stickyAttachmentStyle","filePickerStyle","fileListStyle","fileItemStyle","stickyAttachButtonStyle","stickyButtonStyle","emojiButtonStyle","sendButtonStyle","reactionBtnStyle","stickerBtnStyle","heartIcon","CometChatMessageComposer","PureComponent","constructor","props","enableLiveReaction","context","FeatureRestriction","isLiveReactionsEnabled","then","response","state","setState","catch","error","enablePolls","isPollsEnabled","enableTypingIndicator","isTypingIndicatorsEnabled","enableStickers","isStickersEnabled","enablePhotosVideos","isPhotosVideosEnabled","enableFiles","isFilesEnabled","enableEmojis","isEmojisEnabled","enableCollaborativeDocument","isCollaborativeDocumentEnabled","enableCollaborativeWhiteboard","isCollaborativeWhiteBoardEnabled","focusOnMessageComposer","messageInputRef","current","focus","emojiClicked","emoji","event","messageToReact","reactToMessages","element","pasteHtmlAtCaret","native","messageInput","innerText","messageType","changeHandler","startTyping","elem","currentTarget","textContent","trim","length","toggleFilePicker","currentState","showFilePicker","openFileDialogue","fileType","imageUploaderRef","click","fileUploaderRef","audioUploaderRef","videoUploaderRef","onImageChange","e","files","uploadedFile","reader","FileReader","addEventListener","newFile","File","result","name","sendMediaMessage","MESSAGE_TYPE","IMAGE","readAsArrayBuffer","onFileChange","FILE","onAudioChange","AUDIO","onVideoChange","VIDEO","getReceiverDetails","receiverId","receiverType","type","ACTION_TYPE","TYPE_USER","item","uid","RECEIVER_TYPE","USER","TYPE_GROUP","guid","GROUP","endTyping","mediaMessage","MediaMessage","parentMessageId","setParentMessageId","setSender","loggedInUser","setReceiver","setType","setData","category","CATEGORY_MESSAGE","file","_composedAt","_id","play","CONSTANTS","actionGenerated","ACTIONS","sendMessage","message","newMessageObj","sendMessageOnEnter","keyCode","shiftKey","preventDefault","sendTextMessage","emojiViewer","messageToBeEdited","editMessage","textMessage","TextMessage","setText","replyPreview","hasOwnProperty","code","messageText","setId","id","newMessage","Object","assign","messageFrom","closeEditPreview","timer","metadata","typingInterval","isTyping","typingMetadata","undefined","typingNotification","TypingIndicator","setTimeout","persist","clearTimeout","toggleStickerPicker","stickerViewer","toggleEmojiPicker","toggleCreatePoll","createPoll","toggleCollaborativeDocument","callExtension","receiver","setToastMessage","toggleCollaborativeBoard","closeCreatePoll","actionHandler","action","sendSticker","stickerMessage","customData","sticker_url","stickerUrl","sticker_name","stickerName","customType","CUSTOM_TYPE_STICKER","customMessage","CustomMessage","setMetadata","incrementUnreadCount","sendCustomMessage","sendReplyMessage","clearReplyPreview","sendReaction","reaction","msgId","colons","createRef","shareDocument","shareWhiteboard","componentDidMount","getLoggedinUser","user","componentDidUpdate","prevProps","prevState","text","xssData","hasXSS","sanitized_text","previousMessageStr","JSON","stringify","currentMessageStr","html","selectPastedContent","sel","range","chatWindow","UIKitSettings","getSelection","getRangeAt","rangeCount","deleteContents","el","document","createElement","frag","createDocumentFragment","node","lastNode","firstChild","appendChild","firstNode","insertNode","cloneRange","setStartAfter","setStartBefore","collapse","removeAllRanges","addRange","selection","originalRange","createRange","pasteHTML","setEndPoint","select","render","liveReactionBtn","liveReactionText","translate","lang","reactionName","disabledState","blockedByMe","docText","docs","docIcon","videoText","audioText","imageText","avp","videoIcon","audioIcon","imageIcon","pollText","createPollBtn","pollIcon","collaborativeDocText","collaborativeDocBtn","documentIcon","collaborativeBoardText","collaborativeBoardBtn","whiteboardIcon","emojiText","emojiBtn","insertEmoticon","StickerText","stickerBtn","stickerIcon","sendMessageText","sendBtn","sendBlue","attachText","attach","roundedPlus","getDirection","widgetsettings","editPreview","maskedData","data","sensitive_data","message_masked","profaneData","profanity","message_clean","closeIcon","smartReplyPreview","smartReplyData","options","contextType","defaultProps","getDefaultLanguage","propTypes","string","object"],"mappings":"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","sourcesContent":["import React from \"react\";\n/** @jsxRuntime classic */\n/** @jsx jsx */\nimport { jsx, keyframes } from \"@emotion/core\";\nimport PropTypes from \"prop-types\";\nimport { CometChat } from \"@cometchat-pro/chat\";\n\nimport \"emoji-mart/css/emoji-mart.css\";\n\nimport { CometChatSmartReplyPreview, CometChatCreatePoll, CometChatStickerKeyboard } from \"../Extensions\";\nimport { CometChatEmojiKeyboard } from \"../\";\n\nimport { CometChatContext } from \"../../../util/CometChatContext\";\nimport { checkMessageForExtensionsData, ID, getUnixTimestamp } from \"../../../util/common\";\nimport * as enums from \"../../../util/enums.js\";\nimport { SoundManager } from \"../../../util/SoundManager\";\n\nimport { theme } from \"../../../resources/theme\";\nimport Translator from \"../../../resources/localization/translator\";\n\nimport {\n\tchatComposerStyle,\n\teditPreviewContainerStyle,\n\tpreviewHeadingStyle,\n\tpreviewCloseStyle,\n\tpreviewTextStyle,\n\tcomposerInputStyle,\n\tinputInnerStyle,\n\tmessageInputStyle,\n\tinputStickyStyle,\n\tstickyAttachmentStyle,\n\tfilePickerStyle,\n\tfileListStyle,\n\tfileItemStyle,\n\tstickyAttachButtonStyle,\n\tstickyButtonStyle,\n\temojiButtonStyle,\n\tsendButtonStyle,\n\treactionBtnStyle,\n\tstickerBtnStyle\n} from \"./style\";\n\nimport roundedPlus from \"./resources/add-circle-filled.svg\";\nimport videoIcon from \"./resources/video.svg\";\nimport audioIcon from \"./resources/audio-file.svg\";\nimport docIcon from \"./resources/file-upload.svg\";\nimport imageIcon from \"./resources/image.svg\";\nimport insertEmoticon from \"./resources/emoji.svg\";\nimport sendBlue from \"./resources/send-message.svg\";\nimport pollIcon from \"./resources/polls.svg\";\nimport stickerIcon from \"./resources/stickers.svg\";\nimport closeIcon from \"./resources/close.svg\";\nimport documentIcon from \"./resources/collaborative-document.svg\";\nimport whiteboardIcon from \"./resources/collaborative-whiteboard.svg\";\nimport heartIcon from \"./resources/heart.png\";\n\nclass CometChatMessageComposer extends React.PureComponent {\n\tstatic contextType = CometChatContext;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.imageUploaderRef = React.createRef();\n\t\tthis.fileUploaderRef = React.createRef();\n\t\tthis.audioUploaderRef = React.createRef();\n\t\tthis.videoUploaderRef = React.createRef();\n\t\tthis.messageInputRef = React.createRef();\n\n\t\tthis.isTyping = false;\n\n\t\tthis.state = {\n\t\t\tshowFilePicker: false,\n\t\t\tmessageInput: \"\",\n\t\t\tmessageType: \"\",\n\t\t\temojiViewer: false,\n\t\t\tcreatePoll: false,\n\t\t\tmessageToBeEdited: \"\",\n\t\t\treplyPreview: null,\n\t\t\tstickerViewer: false,\n\t\t\tmessageToReact: \"\",\n\t\t\tshareDocument: false,\n\t\t\tshareWhiteboard: false,\n\t\t\tenableLiveReaction: false,\n\t\t\tenablePolls: false,\n\t\t\tenableTypingIndicator: false,\n\t\t\tenableStickers: false,\n\t\t\tenablePhotosVideos: false,\n\t\t\tenableFiles: false,\n\t\t\tenableEmojis: false,\n\t\t\tenableCollaborativeDocument: false,\n\t\t\tenableCollaborativeWhiteboard: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\n\t\tCometChat.getLoggedinUser()\n\t\t\t.then(user => (this.loggedInUser = user))\n\t\t\t.catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n\n\t\tthis.item = this.context.type === CometChat.ACTION_TYPE.TYPE_USER || this.context.type === CometChat.ACTION_TYPE.TYPE_GROUP ? this.context.item : null;\n\t\tthis.enableLiveReaction();\n\t\tthis.enablePolls();\n\t\tthis.enableTypingIndicator();\n\t\tthis.enableStickers();\n\t\tthis.enablePhotosVideos();\n\t\tthis.enableFiles();\n\t\tthis.enableEmojis();\n\t\tthis.enableCollaborativeDocument();\n\t\tthis.enableCollaborativeWhiteboard();\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (prevProps.messageToBeEdited !== this.props.messageToBeEdited) {\n\t\t\tconst messageToBeEdited = this.props.messageToBeEdited;\n\n\t\t\tthis.setState({messageInput: messageToBeEdited, messageToBeEdited: messageToBeEdited});\n\n\t\t\tconst element = this.messageInputRef.current;\n\t\t\tif (messageToBeEdited) {\n\t\t\t\tlet messageText = messageToBeEdited.text;\n\n\t\t\t\t//xss extensions data\n\t\t\t\tconst xssData = checkMessageForExtensionsData(messageToBeEdited, \"xss-filter\");\n\t\t\t\tif (xssData && xssData.hasOwnProperty(\"sanitized_text\") && xssData.hasOwnProperty(\"hasXSS\") && xssData.hasXSS === \"yes\") {\n\t\t\t\t\tmessageText = xssData.sanitized_text;\n\t\t\t\t}\n\n\t\t\t\telement.focus();\n\t\t\t\telement.textContent = \"\";\n\t\t\t\tthis.pasteHtmlAtCaret(messageText, false);\n\t\t\t} else {\n\t\t\t\telement.textContent = \"\";\n\t\t\t}\n\t\t}\n\n\t\tif (prevProps.replyPreview !== this.props.replyPreview) {\n\t\t\tthis.setState({replyPreview: this.props.replyPreview});\n\t\t}\n\n\t\tconst previousMessageStr = JSON.stringify(prevProps.messageToReact);\n\t\tconst currentMessageStr = JSON.stringify(this.props.messageToReact);\n\n\t\tif (previousMessageStr !== currentMessageStr) {\n\t\t\tthis.setState({messageToReact: this.props.messageToReact});\n\t\t}\n\n\t\tif (this.context.item !== this.item) {\n\t\t\tthis.messageInputRef.current.textContent = \"\";\n\t\t\tthis.setState({stickerViewer: false, emojiViewer: false, replyPreview: null, messageToBeEdited: \"\", messageInput: \"\"});\n\n\t\t\tthis.focusOnMessageComposer();\n\t\t}\n\n\t\tif (prevState.messageInput !== this.state.messageInput) {\n\t\t\tthis.focusOnMessageComposer();\n\t\t}\n\n\t\tthis.item = this.context.type === CometChat.ACTION_TYPE.TYPE_USER || this.context.type === CometChat.ACTION_TYPE.TYPE_GROUP ? this.context.item : null;\n\t\tthis.enableLiveReaction();\n\t\tthis.enablePolls();\n\t\tthis.enableTypingIndicator();\n\t\tthis.enableStickers();\n\t\tthis.enablePhotosVideos();\n\t\tthis.enableFiles();\n\t\tthis.enableEmojis();\n\t\tthis.enableCollaborativeDocument();\n\t\tthis.enableCollaborativeWhiteboard();\n\t}\n\n\t/**\n\t * if live reactions feature is disabled\n\t */\n\tenableLiveReaction = () => {\n\n\t\tthis.context.FeatureRestriction.isLiveReactionsEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableLiveReaction) {\n\t\t\t\t\tthis.setState({enableLiveReaction: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableLiveReaction !== false) {\n\t\t\t\t\tthis.setState({enableLiveReaction: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if polls feature is disabled\n\t */\n\tenablePolls = () => {\n\t\tthis.context.FeatureRestriction.isPollsEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enablePolls) {\n\t\t\t\t\tthis.setState({enablePolls: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enablePolls !== false) {\n\t\t\t\t\tthis.setState({enablePolls: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if typing indicator feature is disabled\n\t */\n\tenableTypingIndicator = () => {\n\t\tthis.context.FeatureRestriction.isTypingIndicatorsEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableTypingIndicator) {\n\t\t\t\t\tthis.setState({enableTypingIndicator: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableTypingIndicator !== false) {\n\t\t\t\t\tthis.setState({enableTypingIndicator: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if stickers feature is disabled\n\t */\n\tenableStickers = () => {\n\t\tthis.context.FeatureRestriction.isStickersEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableStickers) {\n\t\t\t\t\tthis.setState({enableStickers: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableStickers !== false) {\n\t\t\t\t\tthis.setState({enableStickers: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if uploding photos, videos feature is disabled\n\t */\n\tenablePhotosVideos = () => {\n\t\tthis.context.FeatureRestriction.isPhotosVideosEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enablePhotosVideos) {\n\t\t\t\t\tthis.setState({enablePhotosVideos: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enablePhotosVideos !== false) {\n\t\t\t\t\tthis.setState({enablePhotosVideos: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if uploding files feature is disabled\n\t */\n\tenableFiles = () => {\n\t\tthis.context.FeatureRestriction.isFilesEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableFiles) {\n\t\t\t\t\tthis.setState({enableFiles: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableFiles !== false) {\n\t\t\t\t\tthis.setState({enableFiles: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if sending emojis feature is disabled\n\t */\n\tenableEmojis = () => {\n\t\tthis.context.FeatureRestriction.isEmojisEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableEmojis) {\n\t\t\t\t\tthis.setState({enableEmojis: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableEmojis !== false) {\n\t\t\t\t\tthis.setState({enableEmojis: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if sharing collborative document feature is disabled\n\t */\n\tenableCollaborativeDocument = () => {\n\t\tthis.context.FeatureRestriction.isCollaborativeDocumentEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableCollaborativeDocument) {\n\t\t\t\t\tthis.setState({enableCollaborativeDocument: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableCollaborativeDocument !== false) {\n\t\t\t\t\tthis.setState({enableCollaborativeDocument: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\t/**\n\t * if sharing collborative whiteboard feature is disabled\n\t */\n\tenableCollaborativeWhiteboard = () => {\n\t\tthis.context.FeatureRestriction.isCollaborativeWhiteBoardEnabled()\n\t\t\t.then(response => {\n\t\t\t\tif (response !== this.state.enableCollaborativeWhiteboard) {\n\t\t\t\t\tthis.setState({enableCollaborativeWhiteboard: response});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tif (this.state.enableCollaborativeWhiteboard !== false) {\n\t\t\t\t\tthis.setState({enableCollaborativeWhiteboard: false});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\tfocusOnMessageComposer = () => {\n\t\tif (this.messageInputRef && this.messageInputRef.current) {\n\t\t\tthis.messageInputRef.current.focus();\n\t\t}\n\t};\n\n\tpasteHtmlAtCaret(html, selectPastedContent) {\n\t\tvar sel, range;\n\t\tconst chatWindow = this.context.UIKitSettings.chatWindow;\n\t\tif (chatWindow.getSelection) {\n\t\t\t// IE9 and non-IE\n\t\t\tsel = chatWindow.getSelection();\n\t\t\tif (sel.getRangeAt && sel.rangeCount) {\n\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\trange.deleteContents();\n\n\t\t\t\t// Range.createContextualFragment() would be useful here but is\n\t\t\t\t// only relatively recently standardized and is not supported in\n\t\t\t\t// some browsers (IE9, for one)\n\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\tel.innerText = html;\n\t\t\t\tvar frag = document.createDocumentFragment(),\n\t\t\t\t\tnode,\n\t\t\t\t\tlastNode;\n\t\t\t\twhile ((node = el.firstChild)) {\n\t\t\t\t\tlastNode = frag.appendChild(node);\n\t\t\t\t}\n\t\t\t\tvar firstNode = frag.firstChild;\n\t\t\t\trange.insertNode(frag);\n\n\t\t\t\t// Preserve the selection\n\t\t\t\tif (lastNode) {\n\t\t\t\t\trange = range.cloneRange();\n\t\t\t\t\trange.setStartAfter(lastNode);\n\t\t\t\t\tif (selectPastedContent) {\n\t\t\t\t\t\trange.setStartBefore(firstNode);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\tsel.addRange(range);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ((sel = document.selection) && sel.type !== \"Control\") {\n\t\t\t// IE < 9\n\t\t\tvar originalRange = sel.createRange();\n\t\t\toriginalRange.collapse(true);\n\t\t\tsel.createRange().pasteHTML(html);\n\t\t\tif (selectPastedContent) {\n\t\t\t\trange = sel.createRange();\n\t\t\t\trange.setEndPoint(\"StartToStart\", originalRange);\n\t\t\t\trange.select();\n\t\t\t}\n\t\t}\n\t}\n\n\temojiClicked = (emoji, event) => {\n\t\tif (this.state.messageToReact) {\n\t\t\tthis.reactToMessages(emoji);\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = this.messageInputRef.current;\n\t\telement.focus();\n\t\tthis.pasteHtmlAtCaret(emoji.native, false);\n\t\tthis.setState({messageInput: element.innerText, messageType: \"text\"});\n\t};\n\n\tchangeHandler = event => {\n\t\tthis.startTyping();\n\n\t\tconst elem = event.currentTarget;\n\t\tlet messageInput = elem.textContent.trim();\n\n\t\tif (!messageInput.length) {\n\t\t\tevent.currentTarget.textContent = messageInput;\n\t\t\t//return false;\n\t\t}\n\n\t\tthis.setState({messageInput: elem.innerText, messageType: \"text\"});\n\t};\n\n\ttoggleFilePicker = () => {\n\t\tconst currentState = !this.state.showFilePicker;\n\t\tthis.setState({showFilePicker: currentState});\n\t};\n\n\topenFileDialogue = fileType => {\n\t\tswitch (fileType) {\n\t\t\tcase \"image\":\n\t\t\t\tthis.imageUploaderRef.current.click();\n\t\t\t\tbreak;\n\t\t\tcase \"file\":\n\t\t\t\tthis.fileUploaderRef.current.click();\n\t\t\t\tbreak;\n\t\t\tcase \"audio\":\n\t\t\t\tthis.audioUploaderRef.current.click();\n\t\t\t\tbreak;\n\t\t\tcase \"video\":\n\t\t\t\tthis.videoUploaderRef.current.click();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tonImageChange = e => {\n\t\tif (!this.imageUploaderRef.current.files[\"0\"]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst uploadedFile = this.imageUploaderRef.current.files[\"0\"];\n\n\t\tvar reader = new FileReader(); // Creating reader instance from FileReader() API\n\t\treader.addEventListener(\n\t\t\t\"load\",\n\t\t\tevent => {\n\t\t\t\t// Setting up base64 URL on image\n\n\t\t\t\tconst newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n\t\t\t\tthis.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.IMAGE);\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\n\t\treader.readAsArrayBuffer(uploadedFile);\n\t};\n\n\tonFileChange = e => {\n\t\tif (!this.fileUploaderRef.current.files[\"0\"]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst uploadedFile = this.fileUploaderRef.current.files[\"0\"];\n\n\t\tvar reader = new FileReader(); // Creating reader instance from FileReader() API\n\t\treader.addEventListener(\n\t\t\t\"load\",\n\t\t\tevent => {\n\t\t\t\t// Setting up base64 URL on image\n\n\t\t\t\tconst newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n\t\t\t\tthis.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.FILE);\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\n\t\treader.readAsArrayBuffer(uploadedFile);\n\t};\n\n\tonAudioChange = e => {\n\t\tif (!this.audioUploaderRef.current.files[\"0\"]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst uploadedFile = this.audioUploaderRef.current.files[\"0\"];\n\n\t\tvar reader = new FileReader(); // Creating reader instance from FileReader() API\n\t\treader.addEventListener(\n\t\t\t\"load\",\n\t\t\t() => {\n\t\t\t\t// Setting up base64 URL on image\n\n\t\t\t\tconst newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n\t\t\t\tthis.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.AUDIO);\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\n\t\treader.readAsArrayBuffer(uploadedFile);\n\t};\n\n\tonVideoChange = e => {\n\t\tif (!this.videoUploaderRef.current.files[\"0\"]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst uploadedFile = this.videoUploaderRef.current.files[\"0\"];\n\n\t\tvar reader = new FileReader(); // Creating reader instance from FileReader() API\n\t\treader.addEventListener(\n\t\t\t\"load\",\n\t\t\t() => {\n\t\t\t\t// Setting up base64 URL on image\n\n\t\t\t\tconst newFile = new File([reader.result], uploadedFile.name, uploadedFile);\n\t\t\t\tthis.sendMediaMessage(newFile, CometChat.MESSAGE_TYPE.VIDEO);\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\n\t\treader.readAsArrayBuffer(uploadedFile);\n\t};\n\n\tgetReceiverDetails = () => {\n\t\tlet receiverId;\n\t\tlet receiverType;\n\n\t\tif (this.context.type === CometChat.ACTION_TYPE.TYPE_USER) {\n\t\t\treceiverId = this.context.item.uid;\n\t\t\treceiverType = CometChat.RECEIVER_TYPE.USER;\n\t\t} else if (this.context.type === CometChat.ACTION_TYPE.TYPE_GROUP) {\n\t\t\treceiverId = this.context.item.guid;\n\t\t\treceiverType = CometChat.RECEIVER_TYPE.GROUP;\n\t\t}\n\n\t\treturn {receiverId: receiverId, receiverType: receiverType};\n\t};\n\n\tsendMediaMessage = (messageInput, messageType) => {\n\t\tthis.toggleFilePicker();\n\t\tthis.endTyping(null, null);\n\n\t\tconst {receiverId, receiverType} = this.getReceiverDetails();\n\n\t\tlet mediaMessage = new CometChat.MediaMessage(receiverId, messageInput, messageType, receiverType);\n\t\tif (this.props.parentMessageId) {\n\t\t\tmediaMessage.setParentMessageId(this.props.parentMessageId);\n\t\t}\n\n\t\tmediaMessage.setSender(this.loggedInUser);\n\t\tmediaMessage.setReceiver(this.context.type);\n\t\tmediaMessage.setType(messageType);\n\t\tmediaMessage.setData({\n\t\t\ttype: messageType,\n\t\t\tcategory: CometChat.CATEGORY_MESSAGE,\n\t\t\tname: messageInput[\"name\"],\n\t\t\tfile: messageInput,\n\t\t});\n\t\tmediaMessage._composedAt = getUnixTimestamp();\n\t\tmediaMessage._id = ID();\n\n\t\tSoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [mediaMessage]);\n\n\t\tCometChat.sendMessage(mediaMessage)\n\t\t\t.then(message => {\n\t\t\t\tconst newMessageObj = {...message, _id: mediaMessage._id};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconst newMessageObj = {...mediaMessage, error: error};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n\t\t\t});\n\t};\n\n\tsendMessageOnEnter = event => {\n\t\tif (event.keyCode === 13 && !event.shiftKey) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.sendTextMessage();\n\t\t\treturn true;\n\t\t}\n\t};\n\n\tsendTextMessage = () => {\n\t\tif (this.state.emojiViewer) {\n\t\t\tthis.setState({emojiViewer: false});\n\t\t}\n\n\t\tif (!this.state.messageInput.trim().length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.state.messageToBeEdited) {\n\t\t\tthis.editMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.endTyping(null, null);\n\n\t\tlet {receiverId, receiverType} = this.getReceiverDetails();\n\t\tlet messageInput = this.state.messageInput.trim();\n\n\t\tlet textMessage = new CometChat.TextMessage(receiverId, messageInput, receiverType);\n\t\tif (this.props.parentMessageId) {\n\t\t\ttextMessage.setParentMessageId(this.props.parentMessageId);\n\t\t}\n\t\ttextMessage.setSender(this.loggedInUser);\n\t\ttextMessage.setReceiver(this.context.type);\n\t\ttextMessage.setText(messageInput);\n\t\ttextMessage._composedAt = getUnixTimestamp();\n\t\ttextMessage._id = ID();\n\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [textMessage]);\n\t\tthis.setState({messageInput: \"\", replyPreview: false});\n\n\t\tthis.messageInputRef.current.textContent = \"\";\n\t\tSoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n\n\t\tCometChat.sendMessage(textMessage)\n\t\t\t.then(message => {\n\t\t\t\tconst newMessageObj = {...message, _id: textMessage._id};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconst newMessageObj = {...textMessage, error: error};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n\n\t\t\t\tif (error && error.hasOwnProperty(\"code\") && error.code === \"ERR_GUID_NOT_FOUND\") {\n\t\t\t\t\t//this.context.setDeletedGroupId(this.context.item.guid);\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\teditMessage = () => {\n\t\tthis.endTyping(null, null);\n\n\t\tconst messageToBeEdited = this.props.messageToBeEdited;\n\n\t\tlet {receiverId, receiverType} = this.getReceiverDetails();\n\t\tlet messageText = this.state.messageInput.trim();\n\t\tlet textMessage = new CometChat.TextMessage(receiverId, messageText, receiverType);\n\t\ttextMessage.setId(messageToBeEdited.id);\n\n\t\tconst newMessage = Object.assign({}, textMessage, {messageFrom: messageToBeEdited.messageFrom});\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_EDITED\"], newMessage);\n\n\t\tthis.setState({messageInput: \"\"});\n\t\tthis.messageInputRef.current.textContent = \"\";\n\t\tSoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n\n\t\tthis.closeEditPreview();\n\n\t\tCometChat.editMessage(textMessage)\n\t\t\t.then(message => {\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_EDITED\"], { ...message });\n\t\t\t})\n\t\t\t.catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n\t};\n\n\tcloseEditPreview = () => {\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"CLEAR_EDIT_PREVIEW\"]);\n\t};\n\n\tstartTyping = (timer, metadata) => {\n\t\tlet typingInterval = timer || 5000;\n\n\t\t//if typing indicator feature is disabled\n\t\tif (this.state.enableTypingIndicator === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.isTyping) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {receiverId, receiverType} = this.getReceiverDetails();\n\t\tlet typingMetadata = metadata || undefined;\n\n\t\tlet typingNotification = new CometChat.TypingIndicator(receiverId, receiverType, typingMetadata);\n\t\tCometChat.startTyping(typingNotification);\n\n\t\tthis.isTyping = setTimeout(() => {\n\t\t\tthis.endTyping(null, typingMetadata);\n\t\t}, typingInterval);\n\t};\n\n\tendTyping = (event, metadata) => {\n\t\t//fixing synthetic issue\n\t\tif (event) {\n\t\t\tevent.persist();\n\t\t}\n\n\t\t//if typing indicator is disabled for chat wigdet in dashboard\n\t\tif (this.state.enableTypingIndicator === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {receiverId, receiverType} = this.getReceiverDetails();\n\n\t\tlet typingMetadata = metadata || undefined;\n\n\t\tlet typingNotification = new CometChat.TypingIndicator(receiverId, receiverType, typingMetadata);\n\t\tCometChat.endTyping(typingNotification);\n\n\t\tclearTimeout(this.isTyping);\n\t\tthis.isTyping = null;\n\t};\n\n\ttoggleStickerPicker = () => {\n\t\tconst stickerViewer = this.state.stickerViewer;\n\t\tthis.setState({stickerViewer: !stickerViewer, emojiViewer: false});\n\t};\n\n\ttoggleEmojiPicker = () => {\n\t\tconst emojiViewer = this.state.emojiViewer;\n\t\tthis.setState({emojiViewer: !emojiViewer, stickerViewer: false});\n\t};\n\n\ttoggleCreatePoll = () => {\n\t\tconst createPoll = this.state.createPoll;\n\t\tthis.setState({createPoll: !createPoll});\n\t};\n\n\ttoggleCollaborativeDocument = () => {\n\n\t\tconst {receiverId, receiverType} = this.getReceiverDetails();\n\t\tCometChat.callExtension(\"document\", \"POST\", \"v1/create\", {\n\t\t\treceiver: receiverId,\n\t\t\treceiverType: receiverType,\n\t\t})\n\t\t.then(response => {\n\t\t\t// Response with document url\n\t\t\tif (response && response.hasOwnProperty(\"document_url\")) {\n\t\t\t\tthis.context.setToastMessage(\"success\", \"DOCUMENT_SUCCESS\");\n\t\t\t} else {\n\t\t\t\tthis.context.setToastMessage(\"error\", \"DOCUMENT_FAIL\");\n\t\t\t}\n\t\t})\n\t\t.catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n\t};\n\n\ttoggleCollaborativeBoard = () => {\n\n\t\tconst {receiverId, receiverType} = this.getReceiverDetails();\n\t\tCometChat.callExtension(\"whiteboard\", \"POST\", \"v1/create\", {\n\t\t\treceiver: receiverId,\n\t\t\treceiverType: receiverType,\n\t\t})\n\t\t.then(response => {\n\t\t\t// Response with board_url\n\t\t\tif (response && response.hasOwnProperty(\"board_url\")) {\n\t\t\t\tthis.context.setToastMessage(\"success\", \"WHITEBOARD_SUCCESS\");\n\t\t\t} else {\n\t\t\t\tthis.context.setToastMessage(\"error\", \"WHITEBOARD_FAIL\");\n\t\t\t}\n\t\t})\n\t\t.catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n\t};\n\n\tcloseCreatePoll = () => {\n\t\tthis.toggleCreatePoll();\n\t\tthis.toggleFilePicker();\n\t};\n\n\tactionHandler = (action, message) => {\n\t\tswitch (action) {\n\t\t\tcase enums.ACTIONS[\"POLL_CREATED\"]:\n\t\t\t\tthis.toggleCreatePoll();\n\t\t\t\tthis.toggleFilePicker();\n\t\t\t\tbreak;\n\t\t\tcase enums.ACTIONS[\"SEND_STICKER\"]:\n\t\t\t\tthis.sendSticker(message);\n\t\t\t\tbreak;\n\t\t\tcase enums.ACTIONS[\"CLOSE_STICKER_KEYBOARD\"]:\n\t\t\t\tthis.toggleStickerPicker();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tsendSticker = stickerMessage => {\n\t\tconst {receiverId, receiverType} = this.getReceiverDetails();\n\n\t\tconst customData = {sticker_url: stickerMessage.stickerUrl, sticker_name: stickerMessage.stickerName};\n\t\tconst customType = enums.CUSTOM_TYPE_STICKER;\n\n\t\tconst customMessage = new CometChat.CustomMessage(receiverId, receiverType, customType, customData);\n\t\tif (this.props.parentMessageId) {\n\t\t\tcustomMessage.setParentMessageId(this.props.parentMessageId);\n\t\t}\n\t\tcustomMessage.setSender(this.loggedInUser);\n\t\tcustomMessage.setReceiver(this.context.type);\n\t\tcustomMessage.setMetadata({ incrementUnreadCount: true });\n\t\tcustomMessage._composedAt = getUnixTimestamp();\n\t\tcustomMessage._id = ID();\n\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [customMessage]);\n\t\tSoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n\n\t\tCometChat.sendCustomMessage(customMessage)\n\t\t\t.then(message => {\n\t\t\t\tconst newMessageObj = {...message, _id: customMessage._id};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconst newMessageObj = {...customMessage, error: error};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n\t\t\t});\n\t};\n\n\tsendReplyMessage = messageInput => {\n\t\tlet {receiverId, receiverType} = this.getReceiverDetails();\n\n\t\tlet textMessage = new CometChat.TextMessage(receiverId, messageInput, receiverType);\n\t\tif (this.props.parentMessageId) {\n\t\t\ttextMessage.setParentMessageId(this.props.parentMessageId);\n\t\t}\n\t\ttextMessage.setSender(this.loggedInUser);\n\t\ttextMessage.setReceiver(this.context.type);\n\t\ttextMessage._composedAt = getUnixTimestamp();\n\t\ttextMessage._id = ID();\n\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_COMPOSED\"], [textMessage]);\n\n\t\tSoundManager.play(enums.CONSTANTS.AUDIO[\"OUTGOING_MESSAGE\"], this.context);\n\t\tthis.setState({replyPreview: null});\n\n\t\tCometChat.sendMessage(textMessage)\n\t\t\t.then(message => {\n\t\t\t\tconst newMessageObj = {...message, _id: textMessage._id};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"MESSAGE_SENT\"], [newMessageObj]);\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconst newMessageObj = {...textMessage, error: error};\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"ERROR_IN_SENDING_MESSAGE\"], [newMessageObj]);\n\t\t\t});\n\t};\n\n\tclearReplyPreview = () => {\n\t\tthis.setState({replyPreview: null});\n\t};\n\n\tsendReaction = event => {\n\t\tconst typingInterval = 1000;\n\n\t\tconst typingMetadata = {type: enums.CONSTANTS[\"METADATA_TYPE_LIVEREACTION\"], reaction: this.props.reaction};\n\n\t\tthis.startTyping(typingInterval, typingMetadata);\n\t\tthis.props.actionGenerated(enums.ACTIONS[\"SEND_LIVE_REACTION\"]);\n\n\t\tevent.persist();\n\n\t\tsetTimeout(() => {\n\t\t\t//this.endTyping(null, typingMetadata);\n\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"STOP_LIVE_REACTION\"]);\n\t\t}, typingInterval);\n\t};\n\n\treactToMessages = emoji => {\n\n\t\tCometChat.callExtension(\"reactions\", \"POST\", \"v1/react\", {\n\t\t\tmsgId: this.state.messageToReact.id,\n\t\t\temoji: emoji.colons,\n\t\t})\n\t\t.then(response => {\n\t\t\tif (response.hasOwnProperty(\"success\") && response[\"success\"] === true) {\n\t\t\t\tthis.toggleEmojiPicker();\n\t\t\t} else {\n\t\t\t\tthis.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\");\n\t\t\t}\n\t\t})\n\t\t.catch(error => this.props.actionGenerated(enums.ACTIONS[\"ERROR\"], [], \"SOMETHING_WRONG\"));\n\t};\n\n\trender() {\n\t\t\n\t\tlet liveReactionBtn = null;\n\t\tconst liveReactionText = Translator.translate(\"LIVE_REACTION\", this.props.lang);\n\t\tif (enums.CONSTANTS[\"LIVE_REACTIONS\"].hasOwnProperty(this.props.reaction)) {\n\t\t\tconst reactionName = this.props.reaction;\n\t\t\tliveReactionBtn = (\n\t\t\t\t<div title={liveReactionText} css={reactionBtnStyle()} className=\"button__reactions\" onClick={this.sendReaction}>\n\t\t\t\t\t<img src={heartIcon} alt={reactionName} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\tlet disabledState = false;\n\t\tif (this.context.item.blockedByMe) {\n\t\t\tdisabledState = true;\n\t\t}\n\n\t\tconst docText = Translator.translate(\"ATTACH_FILE\", this.props.lang);\n\t\tlet docs = (\n\t\t\t<div\n\t\t\t\ttitle={docText}\n\t\t\t\tcss={fileItemStyle(docIcon, this.context)}\n\t\t\t\tclassName=\"filelist__item item__file\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\tthis.openFileDialogue(\"file\");\n\t\t\t\t}}>\n\t\t\t\t<i></i>\n\t\t\t\t<input onChange={this.onFileChange} type=\"file\" id=\"file\" ref={this.fileUploaderRef} />\n\t\t\t</div>\n\t\t);\n\n\t\tconst videoText = Translator.translate(\"ATTACH_VIDEO\", this.props.lang);\n\t\tconst audioText = Translator.translate(\"ATTACH_AUDIO\", this.props.lang);\n\t\tconst imageText = Translator.translate(\"ATTACH_IMAGE\", this.props.lang);\n\t\tlet avp = (\n\t\t\t<React.Fragment>\n\t\t\t\t<div\n\t\t\t\t\ttitle={videoText}\n\t\t\t\t\tcss={fileItemStyle(videoIcon, this.context)}\n\t\t\t\t\tclassName=\"filelist__item item__video\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.openFileDialogue(\"video\");\n\t\t\t\t\t}}>\n\t\t\t\t\t<i></i>\n\t\t\t\t\t<input onChange={this.onVideoChange} accept=\"video/*\" type=\"file\" ref={this.videoUploaderRef} />\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\ttitle={audioText}\n\t\t\t\t\tcss={fileItemStyle(audioIcon, this.context)}\n\t\t\t\t\tclassName=\"filelist__item item__audio\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.openFileDialogue(\"audio\");\n\t\t\t\t\t}}>\n\t\t\t\t\t<i></i>\n\t\t\t\t\t<input onChange={this.onAudioChange} accept=\"audio/*\" type=\"file\" ref={this.audioUploaderRef} />\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\ttitle={imageText}\n\t\t\t\t\tcss={fileItemStyle(imageIcon, this.context)}\n\t\t\t\t\tclassName=\"filelist__item item__image\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.openFileDialogue(\"image\");\n\t\t\t\t\t}}>\n\t\t\t\t\t<i></i>\n\t\t\t\t\t<input onChange={this.onImageChange} accept=\"image/*\" type=\"file\" ref={this.imageUploaderRef} />\n\t\t\t\t</div>\n\t\t\t</React.Fragment>\n\t\t);\n\n\t\tconst pollText = Translator.translate(\"CREATE_POLL\", this.props.lang);\n\t\tlet createPollBtn = (\n\t\t\t<div title={pollText} css={fileItemStyle(pollIcon, this.context)} className=\"filelist__item item__poll\" onClick={this.toggleCreatePoll}>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t);\n\n\t\tconst collaborativeDocText = Translator.translate(\"COLLABORATE_USING_DOCUMENT\", this.props.lang);\n\t\tlet collaborativeDocBtn = (\n\t\t\t<div title={collaborativeDocText} css={fileItemStyle(documentIcon, this.context)} className=\"filelist__item item__document\" onClick={this.toggleCollaborativeDocument}>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t);\n\n\t\tconst collaborativeBoardText = Translator.translate(\"COLLABORATE_USING_WHITEBOARD\", this.props.lang);\n\t\tlet collaborativeBoardBtn = (\n\t\t\t<div title={collaborativeBoardText} css={fileItemStyle(whiteboardIcon, this.context)} className=\"filelist__item item__whiteboard\" onClick={this.toggleCollaborativeBoard}>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t);\n\n\t\tconst emojiText = Translator.translate(\"EMOJI\", this.props.lang);\n\t\tlet emojiBtn = (\n\t\t\t<div\n\t\t\t\ttitle={emojiText}\n\t\t\t\tcss={emojiButtonStyle(insertEmoticon, this.context)}\n\t\t\t\tclassName=\"button__emoji\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\tthis.toggleEmojiPicker();\n\t\t\t\t\tthis.setState({ messageToReact: \"\" });\n\t\t\t\t}}>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t);\n\n\t\tconst StickerText = Translator.translate(\"STICKER\", this.props.lang);\n\t\tlet stickerBtn = (\n\t\t\t<div title={StickerText} css={stickerBtnStyle(stickerIcon, this.context)} className=\"button__sticker\" onClick={this.toggleStickerPicker}>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t);\n\n\t\tconst sendMessageText = Translator.translate(\"SEND_MESSAGE\", this.props.lang);\n\t\tlet sendBtn = (\n\t\t\t<div title={sendMessageText} css={sendButtonStyle(sendBlue, this.context)} className=\"button__send\" onClick={this.sendTextMessage}>\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t);\n\n\t\t//if uploading photos, videos feature is disabled\n\t\tif (this.state.enablePhotosVideos === false) {\n\t\t\tavp = null;\n\t\t}\n\n\t\t//if files upload are disabled for chat widget in dashboard\n\t\tif (this.state.enableFiles === false) {\n\t\t\tdocs = null;\n\t\t}\n\n\t\t//if polls feature is disabled\n\t\tif (this.state.enablePolls === false || this.props.parentMessageId) {\n\t\t\tcreatePollBtn = null;\n\t\t}\n\n\t\t//if collaborative_document are disabled for chat widget in dashboard\n\t\tif (this.state.enableCollaborativeDocument === false || this.props.parentMessageId) {\n\t\t\tcollaborativeDocBtn = null;\n\t\t}\n\n\t\t//if collaborative_document are disabled for chat widget in dashboard\n\t\tif (this.state.enableCollaborativeWhiteboard === false || this.props.parentMessageId) {\n\t\t\tcollaborativeBoardBtn = null;\n\t\t}\n\n\t\t//if emojis are disabled for chat widget in dashboard\n\t\tif (this.state.enableEmojis === false) {\n\t\t\temojiBtn = null;\n\t\t}\n\n\t\t//if live reactions is disabled for chat widget in dashboard\n\t\tif (this.state.enableLiveReaction === false || this.state.messageInput.length) {\n\t\t\tliveReactionBtn = null;\n\t\t}\n\n\t\t//if stickers is disabled for chat widget in dashboard\n\t\tif (this.state.enableStickers === false) {\n\t\t\tstickerBtn = null;\n\t\t}\n\n\t\tif (!this.state.messageInput.length) {\n\t\t\tsendBtn = null;\n\t\t}\n\n\t\tconst attachText = Translator.translate(\"ATTACH\", this.props.lang);\n\t\tlet attach = (\n\t\t\t<div css={stickyAttachmentStyle()} className=\"input__sticky__attachment\">\n\t\t\t\t<div css={stickyAttachButtonStyle(roundedPlus, this.context)} className=\"attachment__icon\" onClick={this.toggleFilePicker} title={attachText}>\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\t\t\t\t<div css={filePickerStyle(this.state)} className=\"attachment__filepicker\" dir={Translator.getDirection(this.props.lang)}>\n\t\t\t\t\t<div css={fileListStyle()} className=\"filepicker__filelist\">\n\t\t\t\t\t\t{avp}\n\t\t\t\t\t\t{docs}\n\t\t\t\t\t\t{createPollBtn}\n\t\t\t\t\t\t{collaborativeDocBtn}\n\t\t\t\t\t\t{collaborativeBoardBtn}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\n\t\tif (avp === null && docs === null && createPollBtn === null && collaborativeDocBtn === null && collaborativeBoardBtn === null) {\n\t\t\tattach = null;\n\t\t}\n\n\t\tlet createPoll = null;\n\t\tif (this.state.createPoll) {\n\t\t\tcreatePoll = <CometChatCreatePoll theme={this.props.theme} open={this.state.createPoll} close={this.closeCreatePoll} lang={this.props.lang} widgetsettings={this.props.widgetsettings} actionGenerated={this.actionHandler} />;\n\t\t}\n\n\t\tlet editPreview = null;\n\t\tif (this.state.messageToBeEdited) {\n\t\t\tlet messageText = this.state.messageToBeEdited.text;\n\n\t\t\t//xss extensions data\n\t\t\tconst xssData = checkMessageForExtensionsData(this.state.messageToBeEdited, \"xss-filter\");\n\t\t\tif (xssData && xssData.hasOwnProperty(\"sanitized_text\") && xssData.hasOwnProperty(\"hasXSS\") && xssData.hasXSS === \"yes\") {\n\t\t\t\tmessageText = xssData.sanitized_text;\n\t\t\t}\n\n\t\t\t//datamasking extensions data\n\t\t\tconst maskedData = checkMessageForExtensionsData(this.state.messageToBeEdited, \"data-masking\");\n\t\t\tif (maskedData && maskedData.hasOwnProperty(\"data\") && maskedData.data.hasOwnProperty(\"sensitive_data\") && maskedData.data.hasOwnProperty(\"message_masked\") && maskedData.data.sensitive_data === \"yes\") {\n\t\t\t\tmessageText = maskedData.data.message_masked;\n\t\t\t}\n\n\t\t\t//profanity extensions data\n\t\t\tconst profaneData = checkMessageForExtensionsData(this.state.messageToBeEdited, \"profanity-filter\");\n\t\t\tif (profaneData && profaneData.hasOwnProperty(\"profanity\") && profaneData.hasOwnProperty(\"message_clean\") && profaneData.profanity === \"yes\") {\n\t\t\t\tmessageText = profaneData.message_clean;\n\t\t\t}\n\n\t\t\teditPreview = (\n\t\t\t\t<div css={editPreviewContainerStyle(this.context, keyframes)}>\n\t\t\t\t\t<div css={previewHeadingStyle()}>\n\t\t\t\t\t\t<div css={previewTextStyle()}>{Translator.translate(\"EDIT_MESSAGE\", this.props.lang)}</div>\n\t\t\t\t\t\t<span css={previewCloseStyle(closeIcon, this.context)} onClick={this.closeEditPreview}></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>{messageText}</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\tlet smartReplyPreview = null;\n\t\tif (this.state.replyPreview) {\n\t\t\tconst message = this.state.replyPreview;\n\n\t\t\tconst smartReplyData = checkMessageForExtensionsData(message, \"smart-reply\");\n\t\t\tif (smartReplyData && smartReplyData.hasOwnProperty(\"error\") === false) {\n\t\t\t\tconst options = [smartReplyData[\"reply_positive\"], smartReplyData[\"reply_neutral\"], smartReplyData[\"reply_negative\"]];\n\t\t\t\tsmartReplyPreview = <CometChatSmartReplyPreview {...this.props} options={options} clicked={this.sendReplyMessage} close={this.clearReplyPreview} />;\n\t\t\t}\n\t\t}\n\n\t\tlet stickerViewer = null;\n\t\tif (this.state.stickerViewer) {\n\t\t\tstickerViewer = <CometChatStickerKeyboard theme={this.props.theme} lang={this.props.lang} widgetsettings={this.props.widgetsettings} actionGenerated={this.actionHandler} />;\n\t\t}\n\n\t\tlet emojiViewer = null;\n\t\tif (this.state.emojiViewer) {\n\t\t\temojiViewer = <CometChatEmojiKeyboard lang={this.props.lang} emojiClicked={this.emojiClicked} />;\n\t\t}\n\n\t\treturn (\n\t\t\t<div css={chatComposerStyle(this.context)} className=\"chat__composer\">\n\t\t\t\t{editPreview}\n\t\t\t\t{smartReplyPreview}\n\t\t\t\t{stickerViewer}\n\t\t\t\t{emojiViewer}\n\t\t\t\t<div css={composerInputStyle()} className=\"composer__input\">\n\t\t\t\t\t<div tabIndex=\"-1\" css={inputInnerStyle(this.props, this.state, this.context)} className=\"input__inner\">\n\t\t\t\t\t\t<div css={messageInputStyle(disabledState)}\n\t\t\t\t\t\tclassName=\"input__message-input\"\n\t\t\t\t\t\tcontentEditable=\"true\"\n\t\t\t\t\t\tplaceholder={Translator.translate(\"ENTER_YOUR_MESSAGE_HERE\", this.props.lang)}\n\t\t\t\t\t\tdir={Translator.getDirection(this.props.lang)}\n\t\t\t\t\t\tonInput={this.changeHandler}\n\t\t\t\t\t\tonBlur={event => this.endTyping(event)}\n\t\t\t\t\t\tonKeyDown={this.sendMessageOnEnter}\n\t\t\t\t\t\tref={this.messageInputRef}></div>\n\t\t\t\t\t\t<div css={inputStickyStyle(disabledState, attach, this.context)} className=\"input__sticky\">\n\t\t\t\t\t\t\t{attach}\n\t\t\t\t\t\t\t<div css={stickyButtonStyle(this.state)} className=\"input__sticky__buttons\">\n\t\t\t\t\t\t\t\t{stickerBtn}\n\t\t\t\t\t\t\t\t{emojiBtn}\n\t\t\t\t\t\t\t\t{sendBtn}\n\t\t\t\t\t\t\t\t{liveReactionBtn}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{createPoll}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n// Specifies the default values for props:\nCometChatMessageComposer.defaultProps = {\n  lang: Translator.getDefaultLanguage(),\n  theme: theme,\n  reaction: \"heart\"\n};\n\nCometChatMessageComposer.propTypes = {\n  lang: PropTypes.string,\n  theme: PropTypes.object,\n  reaction: PropTypes.string\n}\n\nexport { CometChatMessageComposer };"]},"metadata":{},"sourceType":"module"}